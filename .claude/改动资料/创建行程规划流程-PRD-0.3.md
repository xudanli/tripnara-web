## 0.3 用户与场景（Persona / JTBD / User Journey）

### 0.3.1 用户画像（Persona）

#### **Persona 1：新手用户（First-Time User）**

**基本信息**：
- **姓名**：小李（化名）
- **年龄**：28 岁
- **职业**：互联网产品经理
- **旅行经验**：偶尔旅行，主要依赖攻略和OTA平台

**痛点与需求**：
- **痛点**：
  - 不知道如何开始规划行程
  - 对目的地不熟悉，不知道有哪些景点值得去
  - 不知道如何安排行程顺序和时间
  - 担心规划不合理（时间、预算、安全性）
- **需求**：
  - 用简单的语言描述需求，系统自动生成方案
  - 希望系统提供决策依据（为什么这样安排）
  - 希望看到风险提示和安全建议

**使用场景**：
- 计划春节去冰岛 10 天，预算 10 万元
- 不知道如何安排行程，希望系统帮助规划
- 希望了解极光、冰川等活动的可行性和安全要求

**行为特征**：
- 倾向于使用自然语言输入（符合日常习惯）
- 对澄清问题比较耐心，愿意回答
- 重视系统的解释和决策依据
- 可能会多次调整需求

#### **Persona 2：熟练用户（Experienced User）**

**基本信息**：
- **姓名**：张总（化名）
- **年龄**：35 岁
- **职业**：企业高管
- **旅行经验**：经常旅行，有丰富的规划经验

**痛点与需求**：
- **痛点**：
  - 重复填写表单，操作步骤多
  - 时间成本高（每次都要从头开始）
  - 希望快速生成方案，然后微调
- **需求**：
  - 快速创建行程（减少操作步骤）
  - 系统生成方案后，可以快速调整
  - 希望系统记住偏好（未来）

**使用场景**：
- 临时决定周末去周边城市，需要快速创建行程
- 希望快速看到行程方案，然后根据实际情况调整
- 可能同时规划多个行程

**行为特征**：
- 倾向于使用自然语言输入（快速）
- 对澄清问题比较直接，希望问题少而精准
- 重视效率和速度
- 可能会跳过某些澄清问题（如果觉得不重要）

#### **Persona 3：专业用户（Power User）**

**基本信息**：
- **姓名**：王导（化名）
- **年龄**：40 岁
- **职业**：旅行规划师 / 重度旅行爱好者
- **旅行经验**：专业规划经验，熟悉多个目的地

**痛点与需求**：
- **痛点**：
  - 需要快速生成多个方案供客户选择
  - 需要看到系统的决策过程（向客户解释）
  - 需要评估方案的可行性和风险
- **需求**：
  - 批量创建、决策日志、替代方案
  - 希望系统提供详细的决策依据
  - 希望看到 Gate 评估结果和风险矩阵

**使用场景**：
- 为客户规划多国行程，需要系统评估可行性和风险
- 需要生成多个方案（不同预算、不同偏好）
- 需要向客户解释为什么这样安排

**行为特征**：
- 倾向于使用结构化输入（如果有模板）
- 对澄清问题很重视，希望问题详细
- 重视决策过程和可解释性
- 可能会查看决策日志和 Gate 评估结果

### 0.3.2 用户任务（Jobs to Be Done, JTBD）

#### **JTBD 1：快速创建行程**

**用户任务**：我想快速创建一个可执行的行程方案，不需要花太多时间填写表单。

**成功标准**：
- 用自然语言描述需求
- 系统自动生成可执行的行程方案
- 整个过程在 5 分钟内完成

**用户故事**：
- 作为新手用户，我希望用自然语言描述需求，这样我就不需要理解所有表单字段
- 作为熟练用户，我希望快速创建行程，这样我就能节省时间

#### **JTBD 2：获得智能决策支持**

**用户任务**：我想知道我的需求是否可行，系统能帮我评估风险和提供建议。

**成功标准**：
- 系统执行 Gate 评估，识别风险和约束
- 系统提供调整建议和替代方案
- 用户能看到决策过程和依据

**用户故事**：
- 作为新手用户，我希望系统评估我的需求是否可行，这样我就能提前了解风险
- 作为专业用户，我希望看到 Gate 评估结果和决策日志，这样我就能向客户解释

#### **JTBD 3：理解系统决策**

**用户任务**：我想知道系统为什么这样安排行程，为什么选择这些地点。

**成功标准**：
- 系统提供决策日志（可展开查看）
- 每个行程项都有证据支撑
- 用户能看到 Gate 评估过程和结果

**用户故事**：
- 作为新手用户，我希望看到系统为什么这样安排，这样我就能学习如何规划行程
- 作为专业用户，我希望看到详细的决策过程，这样我就能向客户解释

### 0.3.3 用户旅程（User Journey）

#### **完整用户旅程**

```
阶段 1：意图产生
├─ 触发点：用户想要规划一次旅行
├─ 用户行为：思考目的地、日期、预算
└─ 情绪：期待、不确定

阶段 2：进入创建页面
├─ 触发点：用户点击"创建行程"按钮
├─ 用户行为：
│   ├─ 进入 /dashboard/trips/new 页面
│   ├─ 看到两个选项：自然语言创建 vs 结构化表单
│   └─ 选择自然语言创建（nl tab）
└─ 情绪：好奇、犹豫（不知道选哪个）

阶段 3：输入需求
├─ 触发点：用户选择自然语言创建
├─ 用户行为：
│   ├─ 在文本框中输入需求（例如："帮我规划26年春节去冰岛的10天行程，预算100000元"）
│   ├─ 点击"开始规划"按钮
│   └─ 看到加载状态（thinking / browsing / verifying 等）
└─ 情绪：期待、紧张（不知道系统能否理解）

阶段 4：澄清问题（如果需要）
├─ 触发点：系统返回 NEED_MORE_INFO 状态
├─ 用户行为：
│   ├─ 看到结构化澄清问题（卡片形式）
│   ├─ 回答问题（文本/选择/日期等）
│   ├─ 点击"提交"按钮
│   └─ 可能多轮澄清（最多 5 轮）
└─ 情绪：耐心、稍微不耐烦（如果问题太多）

阶段 5：等待行程生成
├─ 触发点：用户提交澄清答案（或不需要澄清）
├─ 用户行为：
│   ├─ 看到加载状态（planning / verifying / repairing）
│   ├─ 等待系统生成行程（10-30 秒）
│   └─ 可能看到进度提示
└─ 情绪：期待、焦虑（等待时间）

阶段 6：查看行程预览
├─ 触发点：系统返回行程方案
├─ 用户行为：
│   ├─ 查看行程概览（10天行程表）
│   ├─ 查看 Gate 评估结果（风险矩阵、调整建议）
│   ├─ 查看详细行程（每天的具体安排）
│   ├─ 查看决策日志（可展开）
│   └─ 评估方案是否符合需求
└─ 情绪：惊喜、满意（如果方案好）或失望（如果方案不符合预期）

阶段 7：接受或调整
├─ 触发点：用户查看完行程预览
├─ 用户行为：
│   ├─ 接受方案 → 创建行程 → 跳转到行程详情页
│   ├─ 调整方案 → 返回重新规划（循环到阶段 3）
│   └─ 保存为草稿 → 后续继续编辑
└─ 情绪：满意、完成感（如果接受）或挫败（如果不符合预期）

阶段 8：后续使用（接受方案后）
├─ 触发点：用户接受了行程方案
├─ 用户行为：
│   ├─ 在行程详情页查看完整行程
│   ├─ 在 Plan Studio 中继续编辑（如果需要）
│   └─ 执行行程（实际旅行）
└─ 情绪：满足、期待（实际旅行）
```

#### **关键接触点（Touchpoints）**

1. **创建页面入口**（`/dashboard/trips/new`）
   - 用户选择创建方式（自然语言 vs 表单）
   - 关键决策点：用户是否选择自然语言创建

2. **自然语言输入框**
   - 用户输入需求
   - 关键决策点：用户是否输入足够的信息

3. **澄清问题界面**
   - 系统显示结构化问题
   - 关键决策点：用户是否回答所有必填问题

4. **行程预览页面**
   - 系统展示行程方案和 Gate 评估结果
   - 关键决策点：用户是否接受方案

5. **决策日志查看**
   - 用户查看系统决策过程
   - 关键决策点：用户是否信任系统决策

### 0.3.4 用户故事（User Stories）

#### **用户故事 1：新手用户首次规划旅行**

**作为** 一个首次使用 TripNARA 的新手用户  
**我希望** 用自然语言描述我的旅行需求  
**以便** 我不需要理解复杂的表单字段就能创建行程

**验收标准**：
- ✅ 用户可以用自然语言输入需求
- ✅ 系统能够理解用户意图（目的地、日期、预算等）
- ✅ 如果信息不足，系统会通过结构化问题澄清
- ✅ 系统生成的行程方案符合用户需求

**优先级**：P0（核心功能）

#### **用户故事 2：熟练用户快速创建行程**

**作为** 一个经常使用 TripNARA 的熟练用户  
**我希望** 快速创建行程，减少操作步骤  
**以便** 我能节省时间，快速看到行程方案

**验收标准**：
- ✅ 用户可以用自然语言快速输入需求
- ✅ 系统能够快速生成行程方案（< 30 秒）
- ✅ 如果不需要澄清，系统直接生成方案
- ✅ 用户可以在预览页面快速接受或调整

**优先级**：P0（核心功能）

#### **用户故事 3：专业用户查看决策过程**

**作为** 一个旅行规划师  
**我希望** 看到系统决策过程和 Gate 评估结果  
**以便** 我能够向客户解释为什么这样安排，并评估方案的可行性

**验收标准**：
- ✅ 用户可以在行程预览页面查看 Gate 评估结果
- ✅ 用户可以看到风险矩阵（HARD/SOFT/OK 风险）
- ✅ 用户可以通过决策日志查看详细的决策过程
- ✅ 用户可以看到每个行程项的证据支撑

**优先级**：P1（重要功能）

#### **用户故事 4：用户回答澄清问题**

**作为** 一个用户  
**我希望** 通过结构化问题回答系统的澄清需求  
**以便** 系统能够生成更符合我需求的行程方案

**验收标准**：
- ✅ 系统显示结构化的澄清问题（text/single_choice/multi_choice/date/number）
- ✅ 用户可以通过不同的输入方式回答问题
- ✅ 系统验证必填问题和数据格式
- ✅ 用户提交答案后，系统继续生成行程

**优先级**：P0（核心功能）

#### **用户故事 5：用户查看 Gate 评估结果**

**作为** 一个用户  
**我希望** 看到系统对行程可行性的评估结果  
**以便** 我能够了解风险和调整建议，决定是否接受方案

**验收标准**：
- ✅ 用户可以在行程预览页面查看 Gate 评估结果（ALLOW/ADJUST_REQUIRED/BLOCK）
- ✅ 用户可以看到风险矩阵（HARD/SOFT/OK 风险分类）
- ✅ 用户可以看到调整建议（如果有）
- ✅ 用户可以根据 Gate 结果决定是否接受方案

**优先级**：P1（重要功能）

#### **用户故事 6：用户接受或拒绝行程方案**

**作为** 一个用户  
**我希望** 在接受行程前查看完整的方案和评估结果  
**以便** 我能够做出明智的决策

**验收标准**：
- ✅ 用户可以在预览页面查看完整的行程方案
- ✅ 用户可以看到 Gate 评估结果和决策日志
- ✅ 用户可以选择接受、调整或保存为草稿
- ✅ 用户接受后，行程创建成功，跳转到行程详情页

**优先级**：P0（核心功能）

### 0.3.5 极端场景（Edge Cases）

#### **场景 1：用户输入信息不足**

**场景描述**：用户输入的需求信息非常少（例如："去日本"）

**系统行为**：
- 系统返回 `NEED_MORE_INFO` 状态
- 系统生成结构化澄清问题（日期、天数、预算、同行人数等）
- 用户回答后，系统继续生成行程

**用户情绪**：理解（系统需要更多信息）

#### **场景 2：Gate 评估 BLOCK**

**场景描述**：系统评估后，Gate 结果为 `BLOCK`（例如：安全风险过高）

**系统行为**：
- 系统在行程预览页面显示 `BLOCK` 结果
- 系统显示阻止原因和风险详情
- 系统提供替代方案建议
- 用户可以选择"强制继续"（需要审批）或返回重新规划

**用户情绪**：失望、但理解（系统保护用户安全）

#### **场景 3：多轮澄清（超过 5 轮）**

**场景描述**：用户已经回答了 5 轮澄清问题，但系统仍需要更多信息

**系统行为**：
- 系统提示用户"信息不足，建议使用结构化表单创建行程"
- 系统提供"切换到表单模式"选项
- 用户可以选择继续（如果愿意）或切换到表单

**用户情绪**：不耐烦、但可以选择其他方式

#### **场景 4：API 超时**

**场景描述**：系统生成行程时，API 调用超时（> 60 秒）

**系统行为**：
- 系统显示超时提示
- 系统提供"简化需求"选项（重新生成）
- 系统提供"稍后继续"选项（保存为草稿）
- 用户可以选择重试或稍后继续

**用户情绪**：失望、但可以选择重试

#### **场景 5：预算严重超支**

**场景描述**：系统生成的行程预算超出用户预算 50% 以上

**系统行为**：
- 系统自动修复预算（Phase 1）
- 系统显示修复说明（节省金额、调整项）
- 系统在决策日志中记录修复过程
- 用户可以在预览页面查看修复后的方案

**用户情绪**：理解（系统自动优化）

### 0.3.6 用户情绪地图（Emotional Journey）

```
期待 → 好奇 → 期待 → 耐心 → 期待 → 惊喜/失望 → 满意/挫败 → 满足

阶段 1  阶段 2  阶段 3  阶段 4  阶段 5   阶段 6        阶段 7      阶段 8
```

**情绪波动点**：
- **峰值**（阶段 6）：用户看到行程预览时，如果方案好 → 惊喜，如果方案不好 → 失望
- **低谷**（阶段 5）：用户等待行程生成时，可能会焦虑
- **恢复点**（阶段 7）：用户接受方案后，获得完成感

**设计目标**：
- 减少等待时间（阶段 5）的焦虑
- 提升方案质量（阶段 6）的惊喜
- 提供清晰的反馈（所有阶段）

---

**验收标准**：
- ✅ 定义了 3 个用户画像（新手、熟练、专业用户）
- ✅ 定义了用户任务（Jobs to Be Done）
- ✅ 定义了完整的用户旅程（8 个阶段）
- ✅ 定义了关键接触点
- ✅ 定义了至少 3 个用户故事
- ✅ 定义了极端场景和用户情绪地图

---
