# 创建行程规划流程 - 前端和设计师工作清单

**日期**：2025-01-14  
**说明**：本文档列出前端工程师和视觉设计师可以独立完成的工作（不依赖后端API）

---

## 一、前端工程师可以完成的工作

### 1.1 类型定义文件 ✅ **可立即开始**

**任务**：创建 `src/types/clarification.ts` 文件

**内容**：
- `ClarificationQuestionType` 类型定义
- `ClarificationQuestionValidation` 接口
- `ClarificationQuestion` 接口
- `ClarificationAnswer` 接口

**参考**：PRD 0.10.3 节（已补充完整代码）

**状态**：✅ 不依赖后端，可以立即创建

---

### 1.2 组件骨架实现 ✅ **可立即开始**

#### **1.2.1 ClarificationQuestionCard 组件**

**文件路径**：`src/components/trips/ClarificationQuestionCard.tsx`（新建）

**可以完成的部分**：
- ✅ 组件结构和 Props 类型定义
- ✅ 卡片布局（Card、CardHeader、CardContent）
- ✅ 问题标题和提示文本展示
- ✅ 输入组件的骨架（根据 type 渲染不同的组件）
- ✅ 错误提示的展示位置和样式
- ✅ 必填标记（红色星号）

**待后端支持的部分**：
- ❌ 实际数据绑定（等待后端返回 `clarificationQuestions`）
- ❌ 验证逻辑（可以先用 Mock 数据测试）

**参考**：
- PRD 0.10.5 节
- 现有实现：`src/pages/trips/new.tsx` 第 1303-1355 行
- 基础组件：`src/components/ui/card.tsx`、`src/components/ui/textarea.tsx`、`src/components/ui/input.tsx`、`src/components/ui/select.tsx`、`src/components/ui/radio-group.tsx`、`src/components/ui/checkbox.tsx`

#### **1.2.2 ClarificationQuestionsPanel 组件**

**文件路径**：`src/components/trips/ClarificationQuestionsPanel.tsx`（新建）

**可以完成的部分**：
- ✅ 组件结构和 Props 类型定义
- ✅ 整体布局（Card 容器）
- ✅ 问题列表渲染（使用 `ClarificationQuestionCard`）
- ✅ 操作按钮区域（提交、取消按钮）
- ✅ 验证逻辑框架（提交前验证所有必填问题）
- ✅ 轮数限制逻辑（最多 5 轮）

**待后端支持的部分**：
- ❌ 实际数据绑定（等待后端返回 `clarificationQuestions`）
- ❌ 提交逻辑（等待后端API）

**参考**：
- PRD 0.10.5 节
- 现有实现：`src/pages/trips/new.tsx` 第 1303-1355 行

---

### 1.3 向后兼容处理逻辑 ✅ **可立即开始**

**任务**：实现 `clarificationMessage` 解析逻辑

**文件路径**：可以在 `ClarificationQuestionsPanel` 组件中实现，或创建工具函数 `src/utils/clarification.ts`

**可以完成的部分**：
- ✅ 解析 `clarificationMessage`（Markdown 格式字符串）
- ✅ 转换为 `ClarificationQuestion[]` 格式（单个文本类型问题）
- ✅ 函数签名和实现逻辑

**参考**：PRD 0.10.7 节（向后兼容策略）

---

### 1.4 数据验证逻辑 ✅ **可立即开始**

**任务**：实现验证规则处理

**文件路径**：可以在 `ClarificationQuestionCard` 组件中实现，或创建工具函数 `src/utils/clarification-validation.ts`

**可以完成的部分**：
- ✅ 必填验证（`required`）
- ✅ 格式验证（`validation.pattern` 正则表达式）
- ✅ 数值范围验证（`validation.min` / `validation.max`）
- ✅ 日期范围验证（`validation.min` / `validation.max` 时间戳）
- ✅ 错误提示生成

**待后端支持的部分**：
- ❌ 实际数据验证（可以先用 Mock 数据测试）

**参考**：PRD 0.10.6 节（数据验证）

---

### 1.5 状态管理结构设计 ✅ **可立即开始**

**任务**：设计状态管理结构

**文件路径**：`src/pages/trips/new.tsx`

**可以完成的部分**：
- ✅ 状态变量定义（使用 `useState`）
  - `clarificationRound`：澄清轮数
  - `clarificationQuestions`：问题列表
  - `clarificationAnswers`：回答字典
  - `needsClarification`：是否需要澄清
  - `uiStatus`：UI 状态
- ✅ 状态转换逻辑框架（可以先写注释，等后端API）

**参考**：PRD 补充说明 第 四、状态管理的实现说明

---

### 1.6 状态指示器集成 ✅ **可立即开始**

**任务**：集成状态指示器

**选项 1**：使用现有的 `StatusIndicator` 组件（如果导出）
- 检查 `src/components/agent/AgentChat.tsx` 中的 `StatusIndicator` 是否导出
- 如果没有导出，可以复制实现

**选项 2**：创建独立的 `StatusIndicator` 组件
- 文件路径：`src/components/trips/StatusIndicator.tsx`（新建）
- 复制 `src/components/agent/AgentChat.tsx` 中的实现

**可以完成的部分**：
- ✅ 组件实现
- ✅ 状态映射逻辑（`OrchestrationStep` → `UIStatus`）

**参考**：
- PRD 0.11.2 节（状态指示器设计）
- 现有实现：`src/components/agent/AgentChat.tsx` 第 66-149 行

---

## 二、视觉设计师可以完成的工作

### 2.1 设计系统 Token 确认 ✅ **可立即开始**

**任务**：确认澄清问题卡片的颜色方案

**当前 PRD 中的方案**：
- `border-yellow-200 bg-yellow-50/30`

**需要确认**：
- ✅ 是否有对应的设计系统 token？
- ✅ 如果没有，应该使用什么颜色？（需要设计师确认）

**现有代码参考**：
- `src/pages/trips/new.tsx` 第 1304 行：`border-yellow-200 bg-yellow-50/30`
- `src/components/readiness/BlockerCard.tsx`：`bg-yellow-100 text-yellow-800 border-yellow-200`
- `src/components/readiness/RiskCard.tsx`：`bg-yellow-100 text-yellow-800 border-yellow-200`

**建议**：
- 如果设计系统有 `warning` token，使用 `bg-warning/10 border-warning/20`
- 如果没有，使用 `border-yellow-200 bg-yellow-50/30`（与现有实现保持一致）

---

### 2.2 组件视觉样式设计 ✅ **可立即开始**

#### **2.2.1 ClarificationQuestionCard 样式**

**需要设计的内容**：
- ✅ 卡片样式（边框、背景、圆角、阴影）
- ✅ 问题标题样式（字体大小、颜色、粗细）
- ✅ 提示文本样式（字体大小、颜色）
- ✅ 输入组件样式（间距、对齐）
- ✅ 错误提示样式（颜色、位置、字体大小）
- ✅ 必填标记样式（红色星号的位置和大小）

**参考现有组件**：
- `src/components/ui/card.tsx`：Card 组件
- `src/components/trips/ApprovalCard.tsx`：审批卡片样式
- `src/components/readiness/BlockerCard.tsx`：阻塞卡片样式

#### **2.2.2 ClarificationQuestionsPanel 样式**

**需要设计的内容**：
- ✅ 整体容器样式（边框、背景、内边距）
- ✅ 标题区域样式（图标、标题、描述）
- ✅ 问题列表样式（间距、对齐）
- ✅ 操作按钮区域样式（对齐、间距）

**参考现有实现**：
- `src/pages/trips/new.tsx` 第 1304-1354 行：现有澄清问题界面

---

### 2.3 错误提示视觉设计 ✅ **可立即开始**

**任务**：设计错误提示的视觉表现

**需要设计的内容**：
- ✅ 错误文本颜色（建议：`text-red-500`）
- ✅ 错误文本位置（输入框下方，`mt-1`）
- ✅ 错误文本字体大小（建议：`text-sm`）
- ✅ 错误状态的输入框样式（边框颜色、背景颜色）

**参考现有实现**：
- 表单验证错误提示的通用样式

---

### 2.4 响应式布局设计 ✅ **可立即开始**

**任务**：设计响应式布局

**需要设计的内容**：
- ✅ 桌面端布局（≥ 1024px）
- ✅ 平板端布局（768px - 1023px）
- ✅ 移动端布局（< 768px）

**参考**：PRD 0.11.7 节（响应式设计）

---

### 2.5 状态指示器视觉设计 ✅ **可立即开始**

**任务**：确认状态指示器的视觉表现

**当前实现**：
- 已有 `StatusIndicator` 组件（`src/components/agent/AgentChat.tsx`）

**需要确认**：
- ✅ 是否需要修改视觉样式？
- ✅ 是否需要适配创建行程页面的设计风格？

**建议**：
- 如果现有实现符合设计规范，直接使用
- 如果需要调整，可以在 `src/components/trips/StatusIndicator.tsx` 中实现定制版本

---

## 三、可以立即开始的工作优先级

### 3.1 高优先级（不依赖后端）

1. ✅ **类型定义文件**（前端工程师）
   - 创建 `src/types/clarification.ts`
   - 完全独立，不依赖后端

2. ✅ **设计系统 Token 确认**（视觉设计师）
   - 确认颜色方案
   - 影响组件实现

3. ✅ **组件骨架实现**（前端工程师）
   - 创建 `ClarificationQuestionCard` 和 `ClarificationQuestionsPanel` 组件
   - 可以先使用 Mock 数据测试

4. ✅ **状态指示器集成**（前端工程师）
   - 集成或创建 `StatusIndicator` 组件
   - 完全独立，不依赖后端

### 3.2 中优先级（部分依赖后端）

5. ✅ **数据验证逻辑**（前端工程师）
   - 可以实现验证逻辑框架
   - 可以用 Mock 数据测试

6. ✅ **向后兼容处理逻辑**（前端工程师）
   - 可以实现解析逻辑
   - 可以用 Mock 数据测试

7. ✅ **状态管理结构设计**（前端工程师）
   - 可以设计状态结构
   - 状态转换逻辑需要等后端API

### 3.3 低优先级（可以并行进行）

8. ✅ **组件视觉样式设计**（视觉设计师）
   - 可以独立设计，不影响开发

9. ✅ **错误提示视觉设计**（视觉设计师）
   - 可以独立设计，不影响开发

10. ✅ **响应式布局设计**（视觉设计师）
    - 可以独立设计，不影响开发

---

## 四、Mock 数据用于开发测试

### 4.1 Mock 数据结构

**文件路径**：`src/mocks/clarification-questions.ts`（新建，可选）

```typescript
import type { ClarificationQuestion } from '@/types/clarification';

export const mockClarificationQuestions: ClarificationQuestion[] = [
  {
    id: 'question-1',
    question: '请选择您的出行日期',
    type: 'date',
    required: true,
    hint: '建议选择 1 个月后的日期，以便提前预订',
    validation: {
      min: new Date().getTime() + 24 * 60 * 60 * 1000, // 明天
      max: new Date().getTime() + 365 * 24 * 60 * 60 * 1000 * 2, // 2年后
    }
  },
  {
    id: 'question-2',
    question: '同行人数',
    type: 'single_choice',
    required: true,
    options: ['1人', '2人', '3-4人', '5人以上'],
    hint: '这将影响住宿和交通安排'
  },
  {
    id: 'question-3',
    question: '您的主要兴趣（可多选）',
    type: 'multi_choice',
    required: false,
    options: ['极光', '冰川', '温泉', '文化', '美食', '户外运动'],
    hint: '帮助我们为您推荐合适的景点和活动'
  },
  {
    id: 'question-4',
    question: '总预算（人民币）',
    type: 'number',
    required: true,
    placeholder: '例如：100000',
    hint: '包含机票、住宿、餐饮、活动等所有费用',
    validation: {
      min: 100,
      max: 1000000,
    }
  },
  {
    id: 'question-5',
    question: '其他需求或偏好（可选）',
    type: 'text',
    required: false,
    placeholder: '例如：希望体验当地文化、偏好安静的住宿环境等',
    hint: '任何其他需要特别说明的需求'
  }
];
```

**用途**：
- 前端开发时可以暂时使用 Mock 数据
- 组件实现和样式设计不依赖后端API
- 后端API准备好后，替换为实际数据

---

## 五、工作协作建议

### 5.1 前端工程师

**立即可以开始**：
1. 创建类型定义文件
2. 创建组件骨架（使用 Mock 数据）
3. 实现数据验证逻辑框架
4. 实现向后兼容处理逻辑
5. 集成状态指示器

**等后端API后**：
1. 替换 Mock 数据为实际API数据
2. 实现状态转换逻辑
3. 实现提交逻辑
4. 集成到创建页面

### 5.2 视觉设计师

**立即可以开始**：
1. 确认设计系统 Token
2. 设计组件视觉样式
3. 设计错误提示视觉表现
4. 设计响应式布局
5. 确认状态指示器视觉样式

**与前端协作**：
1. 提供设计规范（颜色、间距、字体等）
2. 审查组件实现是否符合设计规范
3. 提供设计稿（如果需要）

---

## 六、参考文档

- **PRD 主文档**：`.claude/改动资料/创建行程规划流程-PRD.md`
- **PRD 补充说明**：`.claude/改动资料/创建行程规划流程-PRD-补充说明-2025-01-14.md`
- **前端角色评审**：`.claude/改动资料/创建行程规划流程-PRD-前端角色评审-2025-01-14.md`

---

**创建日期**：2025-01-14  
**更新日期**：2025-01-14
