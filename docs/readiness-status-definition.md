# å‡†å¤‡åº¦çŠ¶æ€å®šä¹‰è§„èŒƒ

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2026-01-28  
**æœ€åŽæ›´æ–°**: 2026-01-29  
**è´Ÿè´£äºº**: äº§å“ç»ç†ï¼ˆDannyï¼‰

---

## ðŸ“‹ ä¸€ã€çŠ¶æ€å®šä¹‰ï¼ˆ4ä¸ªæ ¸å¿ƒçŠ¶æ€ï¼‰

æ ¹æ®äº§å“éœ€æ±‚æ–‡æ¡£å’ŒAPIæŽ¥å£è§„èŒƒï¼Œå‡†å¤‡åº¦æ£€æŸ¥åº”åŒ…å«ä»¥ä¸‹**4ä¸ªæ ¸å¿ƒçŠ¶æ€**ï¼š

### 1.1 é˜»å¡žé¡¹ï¼ˆBlockerï¼‰
- **è‹±æ–‡æ ‡è¯†**: `blocker`
- **ä¸­æ–‡æ˜¾ç¤º**: `é˜»å¡ž` / `é˜»å¡žé¡¹`
- **å®šä¹‰**: å¿…é¡»è§£å†³çš„é—®é¢˜ï¼Œå¦åˆ™ä¸å…è®¸è¿›å…¥æ‰§è¡Œé˜¶æ®µ
- **ä¸¥é‡ç¨‹åº¦**: æœ€é«˜
- **é¢œè‰²æ ‡è¯†**: çº¢è‰²ï¼ˆ`red`ï¼‰
- **ä¸šåŠ¡è§„åˆ™**: å­˜åœ¨é˜»å¡žé¡¹æ—¶ï¼Œå‡†å¤‡åº¦çŠ¶æ€ä¸º `not-ready`ï¼Œä¸å…è®¸è¿›å…¥æ‰§è¡Œé˜¶æ®µ

### 1.2 å¿…é¡»é¡¹ï¼ˆMustï¼‰
- **è‹±æ–‡æ ‡è¯†**: `must`
- **ä¸­æ–‡æ˜¾ç¤º**: `å¿…é¡»` / `å¿…é¡»é¡¹`
- **å®šä¹‰**: å¼ºçƒˆå»ºè®®å®Œæˆçš„äº‹é¡¹ï¼Œæœªå®Œæˆä¼šæœ‰è­¦å‘Šï¼Œä½†å…è®¸è¿›å…¥æ‰§è¡Œé˜¶æ®µ
- **ä¸¥é‡ç¨‹åº¦**: é«˜
- **é¢œè‰²æ ‡è¯†**: æ©™é»„è‰²ï¼ˆ`amber` / `orange`ï¼‰
- **ä¸šåŠ¡è§„åˆ™**: å­˜åœ¨å¿…é¡»é¡¹æ—¶ï¼Œå‡†å¤‡åº¦çŠ¶æ€ä¸º `nearly`ï¼Œå…è®¸è¿›å…¥æ‰§è¡Œé˜¶æ®µä½†ä¼šæ˜¾ç¤ºè­¦å‘Š

### 1.3 å»ºè®®é¡¹ï¼ˆShouldï¼‰
- **è‹±æ–‡æ ‡è¯†**: `should`
- **ä¸­æ–‡æ˜¾ç¤º**: `å»ºè®®` / `å»ºè®®é¡¹`
- **å®šä¹‰**: å»ºè®®å®Œæˆçš„äº‹é¡¹ï¼Œæœªå®Œæˆä¸å½±å“æ‰§è¡Œ
- **ä¸¥é‡ç¨‹åº¦**: ä¸­
- **é¢œè‰²æ ‡è¯†**: ç°è‰²ï¼ˆ`gray`ï¼‰
- **ä¸šåŠ¡è§„åˆ™**: ä¸å½±å“å‡†å¤‡åº¦çŠ¶æ€åˆ¤æ–­ï¼Œä»…ä½œä¸ºæç¤º

### 1.4 å¯é€‰é¡¹ï¼ˆOptionalï¼‰
- **è‹±æ–‡æ ‡è¯†**: `optional`
- **ä¸­æ–‡æ˜¾ç¤º**: `å¯é€‰` / `å¯é€‰é¡¹`
- **å®šä¹‰**: å¯é€‰å®Œæˆçš„äº‹é¡¹ï¼Œä¸å½±å“å‡†å¤‡åº¦è¯„ä¼°
- **ä¸¥é‡ç¨‹åº¦**: ä½Ž
- **é¢œè‰²æ ‡è¯†**: ç°è‰²ï¼ˆ`gray`ï¼‰
- **ä¸šåŠ¡è§„åˆ™**: ä¸å½±å“å‡†å¤‡åº¦çŠ¶æ€åˆ¤æ–­ï¼Œä»…ä½œä¸ºå‚è€ƒ

---

## ðŸŽ¯ äºŒã€é£Žé™©é¡¹ï¼ˆRisksï¼‰

**é£Žé™©é¡¹**æ˜¯ç‹¬ç«‹äºŽä¸Šè¿°4ä¸ªçŠ¶æ€çš„ç‰¹æ®Šåˆ†ç±»ï¼Œç”¨äºŽæ ‡è¯†æ½œåœ¨é£Žé™©ï¼š

- **è‹±æ–‡æ ‡è¯†**: `risks`
- **ä¸­æ–‡æ˜¾ç¤º**: `é£Žé™©` / `é£Žé™©é¡¹`
- **å®šä¹‰**: è¡Œç¨‹ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£Žé™©ï¼ˆå¤©æ°”ã€åœ°å½¢ã€å®‰å…¨ç­‰ï¼‰
- **ä¸¥é‡ç¨‹åº¦åˆ†çº§**: `high`ï¼ˆé«˜é£Žé™©ï¼‰ã€`medium`ï¼ˆä¸­é£Žé™©ï¼‰ã€`low`ï¼ˆä½Žé£Žé™©ï¼‰
- **é¢œè‰²æ ‡è¯†**: 
  - é«˜é£Žé™©: çº¢è‰²ï¼ˆ`red`ï¼‰
  - ä¸­é£Žé™©: æ©™é»„è‰²ï¼ˆ`amber` / `orange`ï¼‰
  - ä½Žé£Žé™©: ç°è‰²ï¼ˆ`gray`ï¼‰
- **ä¸šåŠ¡è§„åˆ™**: é£Žé™©é¡¹ä¸å½±å“å‡†å¤‡åº¦çŠ¶æ€åˆ¤æ–­ï¼Œä½†ä¼šå½±å“å‡†å¤‡åº¦åˆ†æ•°è®¡ç®—

---

## ðŸ“Š ä¸‰ã€APIæŽ¥å£çŠ¶æ€å­—æ®µæ˜ å°„

### 3.1 ReadinessCheckResult æŽ¥å£ï¼ˆPOST /readiness/checkï¼‰

```typescript
interface ReadinessCheckResult {
  summary: {
    totalBlockers: number;    // âœ… å¯¹åº” blocker
    totalMust: number;         // âœ… å¯¹åº” must
    totalShould: number;       // âœ… å¯¹åº” should
    totalOptional: number;    // âœ… å¯¹åº” optional
    totalRisks?: number;       // âœ… å¯¹åº” risksï¼ˆå¯é€‰ï¼‰
  };
  findings: ReadinessFinding[];
  risks: Risk[];
}
```

### 3.2 PersonalizedChecklistResponse æŽ¥å£ï¼ˆGET /readiness/personalized-checklistï¼‰

```typescript
interface PersonalizedChecklistResponse {
  checklist: {
    blocker: ReadinessFindingItem[];  // âœ… å¯¹åº” blocker
    must: ReadinessFindingItem[];     // âœ… å¯¹åº” must
    should: ReadinessFindingItem[];   // âœ… å¯¹åº” should
    optional: ReadinessFindingItem[]; // âœ… å¯¹åº” optional
  };
  summary: {
    totalBlockers: number;    // âœ… å¯¹åº” blocker
    totalMust: number;        // âœ… å¯¹åº” must
    totalShould: number;      // âœ… å¯¹åº” should
    totalOptional: number;   // âœ… å¯¹åº” optional
  };
}
```

### 3.3 ScoreBreakdownResponse æŽ¥å£ï¼ˆGET /readiness/trip/:id/scoreï¼‰

```typescript
interface ScoreSummary {
  blockers: number;      // âœ… å¯¹åº” blocker
  must: number;          // âœ… å¯¹åº” mustï¼ˆðŸ†• v1.7.0ç»Ÿä¸€ï¼‰
  should: number;        // âœ… å¯¹åº” shouldï¼ˆðŸ†• v1.7.0ç»Ÿä¸€ï¼‰
  warnings?: number;     // âš ï¸ å·²åºŸå¼ƒï¼Œå€¼ç­‰äºŽ mustï¼ˆå‘åŽå…¼å®¹ï¼‰
  suggestions?: number;  // âš ï¸ å·²åºŸå¼ƒï¼Œå€¼ç­‰äºŽ shouldï¼ˆå‘åŽå…¼å®¹ï¼‰
  highRisks: number;     // âœ… å¯¹åº” risksï¼ˆé«˜é£Žé™©ï¼‰
  mediumRisks: number;  // âœ… å¯¹åº” risksï¼ˆä¸­é£Žé™©ï¼‰
  lowRisks: number;      // âœ… å¯¹åº” risksï¼ˆä½Žé£Žé™©ï¼‰
}
```

**ðŸ†• v1.7.0ç»Ÿä¸€**: `ScoreBreakdownResponse.summary` çŽ°åœ¨ä½¿ç”¨æ ‡å‡†çš„ `must` å’Œ `should` å­—æ®µï¼ŒåŒæ—¶ä¿ç•™ `warnings` å’Œ `suggestions` ä»¥ä¿æŒå‘åŽå…¼å®¹ã€‚

### 3.4 ReadinessSummaryDto æŽ¥å£ï¼ˆGET /trips/:id/insightï¼‰

```typescript
interface ReadinessSummaryDto {
  status: ReadinessStatus;
  blockers: number;      // âœ… å¯¹åº” blocker
  must: number;          // âœ… å¯¹åº” mustï¼ˆðŸ†• v1.7.0ç»Ÿä¸€ï¼‰
  should: number;        // âœ… å¯¹åº” shouldï¼ˆðŸ†• v1.7.0ç»Ÿä¸€ï¼‰
  warnings?: number;     // âš ï¸ å·²åºŸå¼ƒï¼Œå€¼ç­‰äºŽ mustï¼ˆå‘åŽå…¼å®¹ï¼‰
  suggestions?: number;  // âš ï¸ å·²åºŸå¼ƒï¼Œå€¼ç­‰äºŽ shouldï¼ˆå‘åŽå…¼å®¹ï¼‰
}
```

---

## ðŸ”§ å››ã€å‰ç«¯æ˜¾ç¤ºçŠ¶æ€æ˜ å°„

### 4.1 ç»Ÿä¸€åŽçš„å®žçŽ°

```typescript
// âœ… æŽ¨èï¼šä½¿ç”¨æ–°å­—æ®µï¼ŒåŒæ—¶å…¼å®¹æ—§å­—æ®µ
const blockers = readinessData?.summary?.blockers ?? 0;
const must = readinessData?.summary?.must ?? 
              readinessData?.summary?.warnings ?? 0;  // å‘åŽå…¼å®¹
const should = readinessData?.summary?.should ?? 
               readinessData?.summary?.suggestions ?? 0; // å‘åŽå…¼å®¹
const optional = readinessData?.summary?.optional ?? 0;
const totalRisks = (readinessData?.summary?.highRisks ?? 0) + 
                   (readinessData?.summary?.mediumRisks ?? 0) + 
                   (readinessData?.summary?.lowRisks ?? 0);
```

### 4.2 ç»Ÿä¸€çš„é¢œè‰²æ ‡è¯†

```typescript
// é˜»å¡žé¡¹
const blockerColor = 'bg-red-50 text-red-700 border-red-500';

// å¿…é¡»é¡¹
const mustColor = 'bg-amber-50 text-amber-700 border-amber-500';

// å»ºè®®é¡¹
const shouldColor = 'bg-gray-50 text-gray-600 border-gray-300';

// å¯é€‰é¡¹
const optionalColor = 'bg-gray-50 text-gray-600 border-gray-300';

// é£Žé™©é¡¹ï¼ˆæ ¹æ®ä¸¥é‡ç¨‹åº¦ï¼‰
const riskColors = {
  high: 'bg-red-50 text-red-700 border-red-500',
  medium: 'bg-amber-50 text-amber-700 border-amber-500',
  low: 'bg-gray-50 text-gray-600 border-gray-300',
};
```

---

## âœ… äº”ã€ç»Ÿä¸€è§„èŒƒ

### 5.1 åŽç«¯APIè§„èŒƒ

**æ ‡å‡†å­—æ®µå‘½å**ï¼ˆæŽ¨èï¼‰:
- `totalBlockers` / `blockers` â†’ é˜»å¡žé¡¹
- `totalMust` / `must` â†’ å¿…é¡»é¡¹
- `totalShould` / `should` â†’ å»ºè®®é¡¹
- `totalOptional` / `optional` â†’ å¯é€‰é¡¹
- `totalRisks` / `risks` â†’ é£Žé™©é¡¹ï¼ˆæŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ä¸º `highRisks`, `mediumRisks`, `lowRisks`ï¼‰

**åºŸå¼ƒå­—æ®µ**ï¼ˆå‘åŽå…¼å®¹ï¼‰:
- `warnings` â†’ åº”æ˜ å°„åˆ° `must`ï¼ˆå€¼ç­‰äºŽ `must`ï¼‰
- `suggestions` â†’ åº”æ˜ å°„åˆ° `should`ï¼ˆå€¼ç­‰äºŽ `should`ï¼‰

### 5.2 å‰ç«¯æ˜¾ç¤ºè§„èŒƒ

**ç»Ÿä¸€çš„ä¸­æ–‡æ˜¾ç¤º**:
- `é˜»å¡ž` / `é˜»å¡žé¡¹` â†’ blocker
- `å¿…é¡»` / `å¿…é¡»é¡¹` â†’ must
- `å»ºè®®` / `å»ºè®®é¡¹` â†’ should
- `å¯é€‰` / `å¯é€‰é¡¹` â†’ optional
- `é£Žé™©` / `é£Žé™©é¡¹` â†’ risks

**ç»Ÿä¸€çš„é¢œè‰²æ ‡è¯†**:
- é˜»å¡žé¡¹: `bg-red-50 text-red-700` / `border-red-500`
- å¿…é¡»é¡¹: `bg-amber-50 text-amber-700` / `border-amber-500`
- å»ºè®®é¡¹: `bg-gray-50 text-gray-600` / `border-gray-300`
- å¯é€‰é¡¹: `bg-gray-50 text-gray-600` / `border-gray-300`
- é£Žé™©é¡¹: æ ¹æ®ä¸¥é‡ç¨‹åº¦ï¼ˆhigh/medium/lowï¼‰ä½¿ç”¨ä¸åŒé¢œè‰²

---

## ðŸ“ å…­ã€å·²ä¿®å¤é—®é¢˜

### 6.1 åŽç«¯APIç»Ÿä¸€ âœ…

- [x] **ScoreBreakdownResponse.summary** å·²ä½¿ç”¨ `must` å’Œ `should`ï¼ŒåŒæ—¶ä¿ç•™ `warnings` å’Œ `suggestions`ï¼ˆå‘åŽå…¼å®¹ï¼‰
- [x] **ReadinessSummaryDto** å·²ä½¿ç”¨ `must` å’Œ `should`ï¼ŒåŒæ—¶ä¿ç•™ `warnings` å’Œ `suggestions`ï¼ˆå‘åŽå…¼å®¹ï¼‰
- [x] **ReadinessScoreFinding.type** æ”¯æŒ `must` å’Œ `should` ç±»åž‹

### 6.2 å‰ç«¯ä»£ç ç»Ÿä¸€ âœ…

- [x] **ScheduleTab.tsx** å·²ä½¿ç”¨ `must` å’Œ `should`ï¼ŒåŒæ—¶å…¼å®¹æ—§å­—æ®µ `warnings` å’Œ `suggestions`
- [x] **ReadinessPage** å·²ä½¿ç”¨ `totalMust` å’Œ `totalShould`ï¼ˆæ¥è‡ª ReadinessCheckResultï¼‰
- [x] æ·»åŠ å‘åŽå…¼å®¹é€»è¾‘ï¼Œæ”¯æŒæ—§å­—æ®µå

### 6.3 æ–‡æ¡£ç»Ÿä¸€ âœ…

- [x] æ›´æ–°APIæ–‡æ¡£ï¼Œæ˜Žç¡®çŠ¶æ€å­—æ®µå‘½åè§„èŒƒ
- [x] æ›´æ–°Swaggeræ–‡æ¡£ï¼ŒåŒ…å«æ–°å­—æ®µè¯´æ˜Ž
- [x] åˆ›å»ºçŠ¶æ€æ˜ å°„è¡¨ï¼Œä¾›å‰åŽç«¯å¼€å‘å‚è€ƒ

---

## ðŸŽ¯ ä¸ƒã€çŠ¶æ€åˆ¤æ–­è§„åˆ™

### 7.1 å‡†å¤‡åº¦çŠ¶æ€ï¼ˆReadinessStatusï¼‰

```typescript
type ReadinessStatus = 'ready' | 'nearly' | 'not-ready';

// åˆ¤æ–­è§„åˆ™
if (totalBlockers > 0) {
  status = 'not-ready';  // å­˜åœ¨é˜»å¡žé¡¹ï¼Œä¸å…è®¸è¿›å…¥æ‰§è¡Œé˜¶æ®µ
} else if (totalMust > 0 && mustCompleted < totalMust) {
  status = 'nearly';      // å­˜åœ¨æœªå®Œæˆçš„å¿…é¡»é¡¹ï¼Œè­¦å‘Šä½†å…è®¸æ‰§è¡Œ
} else {
  status = 'ready';       // å‡†å¤‡å°±ç»ª
}
```

### 7.2 å‡†å¤‡åº¦åˆ†æ•°è®¡ç®—

```typescript
// åˆ†æ•°è®¡ç®—æƒé‡ï¼ˆç¤ºä¾‹ï¼‰
const SCORE_WEIGHTS = {
  BLOCKER_PENALTY: 20,      // æ¯ä¸ª blocker æ‰£ 20 åˆ†
  MUST_PENALTY: 10,         // æ¯ä¸ª must æ‰£ 10 åˆ†
  HIGH_RISK_PENALTY: 10,    // æ¯ä¸ªé«˜é£Žé™©æ‰£ 10 åˆ†
  RISK_PENALTY: 5,          // æ¯ä¸ªé£Žé™©æ‰£ 5 åˆ†
};

const overallScore = Math.max(0, 100 - 
  (totalBlockers * SCORE_WEIGHTS.BLOCKER_PENALTY) - 
  (totalMust * SCORE_WEIGHTS.MUST_PENALTY) -
  (highRiskCount * SCORE_WEIGHTS.HIGH_RISK_PENALTY) - 
  (riskCount * SCORE_WEIGHTS.RISK_PENALTY)
);
```

---

## ðŸ“š å…«ã€ç›¸å…³æŽ¥å£

### å·²ç»Ÿä¸€çš„æŽ¥å£

1. âœ… `POST /readiness/check` - ReadinessCheckResultï¼ˆå·²ä½¿ç”¨æ ‡å‡†å­—æ®µï¼‰
2. âœ… `GET /readiness/personalized-checklist` - PersonalizedChecklistResponseï¼ˆå·²ä½¿ç”¨æ ‡å‡†å­—æ®µï¼‰
3. âœ… `GET /readiness/trip/:tripId/score` - ScoreBreakdownResponseï¼ˆv1.7.0å·²ç»Ÿä¸€ï¼‰
4. âœ… `GET /trips/:id/insight` - ReadinessSummaryDtoï¼ˆv1.7.0å·²ç»Ÿä¸€ï¼‰

---

## ðŸ”„ ä¹ã€å‘åŽå…¼å®¹æ€§

### âœ… å®Œå…¨å‘åŽå…¼å®¹

æ‰€æœ‰æŽ¥å£åŒæ—¶è¿”å›žæ–°æ—§å­—æ®µï¼š

```typescript
{
  summary: {
    blockers: 0,
    must: 2,           // ðŸ†• æ–°å­—æ®µ
    should: 1,        // ðŸ†• æ–°å­—æ®µ
    warnings: 2,      // âš ï¸ åºŸå¼ƒå­—æ®µï¼ˆå€¼ç­‰äºŽ mustï¼‰
    suggestions: 1,   // âš ï¸ åºŸå¼ƒå­—æ®µï¼ˆå€¼ç­‰äºŽ shouldï¼‰
    highRisks: 1,
    mediumRisks: 1,
    lowRisks: 0
  }
}
```

### å‰ç«¯è¿ç§»å»ºè®®

```typescript
// âœ… æŽ¨èï¼šä½¿ç”¨æ–°å­—æ®µï¼ŒåŒæ—¶å…¼å®¹æ—§å­—æ®µ
const must = readinessData?.summary?.must ?? 
              readinessData?.summary?.warnings ?? 0;
const should = readinessData?.summary?.should ?? 
               readinessData?.summary?.suggestions ?? 0;

// âš ï¸ ä¸æŽ¨èï¼šä»…ä½¿ç”¨æ—§å­—æ®µ
const warnings = readinessData?.summary?.warnings;  // å·²åºŸå¼ƒ
```

---

## ðŸ“ åã€å˜æ›´æ—¥å¿—

### v1.7.0 (2026-01-29)
- âœ… ç»Ÿä¸€å­—æ®µå‘½åï¼š`warnings` â†’ `must`ï¼Œ`suggestions` â†’ `should`
- âœ… `ReadinessScoreResponse.summary` æ–°å¢ž `must` å’Œ `should` å­—æ®µ
- âœ… `ReadinessSummaryDto` æ–°å¢ž `must` å’Œ `should` å­—æ®µ
- âœ… `ReadinessScoreFinding.type` æ”¯æŒ `must` å’Œ `should` ç±»åž‹
- âœ… ä¿æŒå‘åŽå…¼å®¹ï¼šä¿ç•™ `warnings` å’Œ `suggestions` å­—æ®µï¼ˆæ ‡è®°ä¸ºåºŸå¼ƒï¼‰
- âœ… æ›´æ–°ç›¸å…³æœåŠ¡ä»£ç ä½¿ç”¨æ–°å­—æ®µå
- âœ… æ›´æ–°APIæ–‡æ¡£å’ŒSwaggeræ–‡æ¡£

---

## âœ… æ€»ç»“

å‡†å¤‡åº¦çŠ¶æ€å­—æ®µå·²æˆåŠŸç»Ÿä¸€ï¼š

1. âœ… **å­—æ®µç»Ÿä¸€**ï¼š`warnings` â†’ `must`ï¼Œ`suggestions` â†’ `should`
2. âœ… **å‘åŽå…¼å®¹**ï¼šä¿ç•™æ—§å­—æ®µï¼Œå€¼ç­‰äºŽæ–°å­—æ®µ
3. âœ… **ç±»åž‹æ”¯æŒ**ï¼šFindingç±»åž‹æ”¯æŒ `must` å’Œ `should`
4. âœ… **æ–‡æ¡£æ›´æ–°**ï¼šAPIæ–‡æ¡£å’ŒSwaggerå·²æ›´æ–°
5. âœ… **å‰ç«¯æ›´æ–°**ï¼šScheduleTab.tsx å·²æ›´æ–°ï¼Œä½¿ç”¨æ–°å­—æ®µå¹¶å…¼å®¹æ—§å­—æ®µ

**ä¸‹ä¸€æ­¥**ï¼š
- â³ æ£€æŸ¥å…¶ä»–å‰ç«¯ç»„ä»¶æ˜¯å¦å®Œå…¨ä½¿ç”¨æ–°å­—æ®µ
- â³ æœªæ¥ç‰ˆæœ¬å¯è€ƒè™‘ç§»é™¤åºŸå¼ƒå­—æ®µ

---

**è§„èŒƒå®Œæˆæ—¶é—´**: 2026-01-29  
**å®žæ–½çŠ¶æ€**: âœ… å·²å®Œæˆï¼Œå‘åŽå…¼å®¹
