# é¡¹ç›®æœªå¯¹æ¥æ¥å£æ¸…å•ï¼ˆå®Œæ•´ç‰ˆï¼‰

**ç”Ÿæˆæ—¶é—´**: 2025-01-01  
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**ç»Ÿè®¡**: å…± **20+** ä¸ªæœªå¯¹æ¥æ¥å£

---

## ğŸ“‹ ç›®å½•

1. [è§„åˆ’å·¥ä½œå°ï¼ˆPlan Studioï¼‰](#1-è§„åˆ’å·¥ä½œå°plan-studio)
2. [è¡Œç¨‹ç®¡ç†æ ¸å¿ƒåŠŸèƒ½](#2-è¡Œç¨‹ç®¡ç†æ ¸å¿ƒåŠŸèƒ½)
3. [Dashboard é¡µé¢](#3-dashboard-é¡µé¢)
4. [EvidenceDrawer ç»„ä»¶](#4-evidencedrawer-ç»„ä»¶)
5. [Insights é¡µé¢](#5-insights-é¡µé¢)
6. [å…¶ä»–åŠŸèƒ½](#6-å…¶ä»–åŠŸèƒ½)

---

## 1. è§„åˆ’å·¥ä½œå°ï¼ˆPlan Studioï¼‰

### 1.1 Abu è§†å›¾ç›¸å…³æ¥å£

#### 1.1.1 é—¨æ§çŠ¶æ€

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/gating-status` | GET | **P0** | â³ å¾…å®ç° | è·å–è¡Œç¨‹é—¨æ§çŠ¶æ€ï¼ˆé€šè¿‡/è­¦å‘Š/æ‹’ç»ï¼‰ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  status: 'ALLOW' | 'WARN' | 'BLOCK',
  violations: {
    hard: number,      // ç¡¬çº¢çº¿æ•°é‡
    soft: number,      // è½¯çº¢çº¿/è­¦å‘Šæ•°é‡
    list?: Array<{
      level: 'HARD' | 'SOFT',
      code: string,
      title: string,
      reason: string,
      affectedItemIds: string[],
    }>,
  },
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (ç­–ç•¥é¢„è§ˆå¡ç‰‡)

---

#### 1.1.2 çº¢çº¿/è­¦å‘Šåˆ—è¡¨

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/violations` | GET | **P0** | â³ å¾…å®ç° | è·å–è¡Œç¨‹çš„çº¢çº¿/è­¦å‘Šè¯¦ç»†åˆ—è¡¨ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  items: Array<{
    level: 'HARD' | 'SOFT',
    code: string,
    title: string,
    reason: string,
    evidence?: Array<{
      field: string,
      value: string,
      timestamp?: string,
    }>,
    affectedItemIds: string[],
  }>,
  total: number,
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (ç­–ç•¥é¢„è§ˆå¡ç‰‡ - æŸ¥çœ‹è¯æ®æŒ‰é’®)

---

#### 1.1.3 é£é™©æç¤º

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/risk-alerts` | GET | **P0** | â³ å¾…å®ç° | è·å–é£é™©æç¤ºåˆ—è¡¨ï¼ˆAbuè§†å›¾ï¼‰ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  items: Array<{
    type: 'MISSING_REQUIRED' | 'BUFFER_INSUFFICIENT' | 'SUNLIGHT_WINDOW' | 'EQUIPMENT' | 'CLOSURE' | 'PERMIT_MISSING',
    severity: 'HIGH' | 'MEDIUM' | 'LOW',
    title: string,
    description: string,
    affectedDays?: string[],
    metadata?: {
      poiId?: string,
      evidenceIds?: string[],
      [key: string]: any,
    },
  }>,
  total: number,
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (æç¤ºå¡ - Abuè§†å›¾)

---

### 1.2 Dr.Dre è§†å›¾ç›¸å…³æ¥å£

#### 1.2.1 è¡Œç¨‹æŒ‡æ ‡

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/metrics` | GET | **P0** | â³ å¾…å®ç° | è·å–è¡Œç¨‹æŒ‡æ ‡æ•°æ® |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  metrics: {
    timeTotal: number,        // æ€»è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰
    bufferTotal: number,      // æ€»ç¼“å†²ï¼ˆåˆ†é’Ÿï¼‰
    fatigueScore: number,     // ç–²åŠ³æŒ‡æ•°ï¼ˆ0-100ï¼‰
    ascent: number,           // æ€»çˆ¬å‡ï¼ˆç±³ï¼‰
    costEstimate: number,     // é¢„è®¡èŠ±è´¹
    distanceTotal: number,    // æ€»è·ç¦»ï¼ˆå…¬é‡Œï¼‰
  },
  weights: {
    comfort: number,          // èˆ’é€‚æƒé‡ï¼ˆ0-100ï¼‰
    experience: number,       // ä½“éªŒæƒé‡ï¼ˆ0-100ï¼‰
    cost: number,             // æˆæœ¬æƒé‡ï¼ˆ0-100ï¼‰
    time?: number,            // æ—¶é—´æƒé‡ï¼ˆå¯é€‰ï¼‰
  },
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (ç­–ç•¥é¢„è§ˆå¡ç‰‡ - Dr.Dreè§†å›¾)

---

#### 1.2.2 æƒé‡é…ç½®ï¼ˆå¯é€‰ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/weights` | PUT | P1 | â³ å¾…å®ç° | æ›´æ–°æƒé‡é…ç½® |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID
- Body: æƒé‡é…ç½®å¯¹è±¡

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (è°ƒæ•´æƒé‡æŒ‰é’®)

---

#### 1.2.3 æŒ‡æ ‡å¼‚å¸¸

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/metric-anomalies` | GET | **P0** | â³ å¾…å®ç° | è·å–æŒ‡æ ‡å¼‚å¸¸åˆ—è¡¨ï¼ˆDr.Dreè§†å›¾ï¼‰ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  items: Array<{
    type: 'FATIGUE_PEAK' | 'BUFFER_INSUFFICIENT' | 'COST_OVER' | 'TIME_CONFLICT' | 'DISTANCE_EXCEED',
    severity: 'HIGH' | 'MEDIUM' | 'LOW',
    title: string,
    description: string,
    currentValue: number,
    threshold: number,
    affectedDays?: string[],
    metadata?: {
      [key: string]: any,
    },
  }>,
  total: number,
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (æç¤ºå¡ - Dr.Dreè§†å›¾)

---

### 1.3 Neptune è§†å›¾ç›¸å…³æ¥å£

#### 1.3.1 ä¿®å¤é˜Ÿåˆ—

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/repairs` | GET | **P0** | â³ å¾…å®ç° | è·å–ä¿®å¤é˜Ÿåˆ—åˆ—è¡¨ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  items: Array<{
    id: string,
    type: 'REPLACE' | 'SKIP' | 'RESCHEDULE' | 'ADD_BUFFER' | 'INSERT_REST',
    severity: 'CRITICAL' | 'WARNING' | 'INFO',
    targetItemId: string,
    description: string,
    beforeMetrics: {
      time: number,
      distance: number,
      effort: number,
      cost: number,
      risk: string,
    },
    afterMetrics: {
      time: number,
      distance: number,
      effort: number,
      cost: number,
      risk: string,
    },
    confidence: number,
    patchOps: Array<{
      op: string,
      path: string,
      value?: any,
    }>,
  }>,
  total: number,
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (ç­–ç•¥é¢„è§ˆå¡ç‰‡ - Neptuneè§†å›¾)

---

#### 1.3.2 ä¿®å¤è¿›åº¦

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/repair-progress` | GET | **P0** | â³ å¾…å®ç° | è·å–ä¿®å¤è¿›åº¦ç»Ÿè®¡ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  total: number,              // å‘ç°é—®é¢˜æ€»æ•°
  applied: number,            // å·²ä¿®å¤æ•°é‡
  pending: number,            // å¾…ä¿®å¤æ•°é‡
  minimalChanges: {
    replacePoints: number,    // éœ€è¦æ›¿æ¢çš„ç‚¹æ•°
    moveTimeSlots: number,    // éœ€è¦ç§»åŠ¨çš„æ—¶æ®µæ•°
    addBuffers?: number,      // éœ€è¦å¢åŠ çš„ç¼“å†²æ•°ï¼ˆå¯é€‰ï¼‰
    skipItems?: number,       // éœ€è¦è·³è¿‡çš„é¡¹æ•°ï¼ˆå¯é€‰ï¼‰
  },
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (ç­–ç•¥é¢„è§ˆå¡ç‰‡ - Neptuneè§†å›¾)

---

#### 1.3.3 ä¿®å¤å»ºè®®

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/repair-suggestions` | GET | **P0** | â³ å¾…å®ç° | è·å–ä¿®å¤å»ºè®®åˆ—è¡¨ï¼ˆNeptuneè§†å›¾ï¼‰ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID

**å“åº”æ ¼å¼**:
```typescript
{
  items: Array<{
    type: 'REPLACE' | 'RESCHEDULE' | 'ADD_BUFFER' | 'ALTERNATIVE_ROUTE' | 'INSERT_REST',
    severity: 'CRITICAL' | 'WARNING' | 'INFO',
    title: string,
    description: string,
    targetItemId?: string,
    alternatives?: Array<{
      placeId: number,
      placeName: string,
      reason: string,
      delta: {
        time: number,
        distance: number,
        cost: number,
      },
    }>,
    metadata?: {
      [key: string]: any,
    },
  }>,
  total: number,
}
```

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (æç¤ºå¡ - Neptuneè§†å›¾)

---

#### 1.3.4 åº”ç”¨ä¿®å¤ï¼ˆå¯é€‰ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/repairs/{repairId}/apply` | POST | P1 | â³ å¾…å®ç° | åº”ç”¨å•ä¸ªä¿®å¤ |
| `/trips/{tripId}/repairs/apply-all` | POST | P1 | â³ å¾…å®ç° | åº”ç”¨æ‰€æœ‰ä¿®å¤ |

**ä½¿ç”¨ä½ç½®**: 
- `src/components/trips/views/NeptuneView.tsx` (åº”ç”¨ä¿®å¤æŒ‰é’®)

---

### 1.4 è§„åˆ’å·¥ä½œå° - å…¶ä»–æ¥å£

#### 1.4.1 è¯æ®è¯¦æƒ…ï¼ˆæŸ¥çœ‹è¯æ®æŒ‰é’®ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/evidence` | GET | P2 | â³ å¾…å®ç° | è·å–è¯æ®è¯¦æƒ…ï¼ˆAbuè§†å›¾ - æŸ¥çœ‹è¯æ®æŒ‰é’®ï¼‰ |

**æ³¨æ„**: æ­¤æ¥å£ä¸ `2.2.1` çš„æ¥å£ç›¸åŒï¼Œå¯ä»¥å¤ç”¨ã€‚

---

#### 1.4.2 Agent æ“ä½œ

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/agent/route-and-run` | POST | **P0** | âœ… å·²å­˜åœ¨ | éœ€è¦æ ¹æ®ä¸åŒè§†å›¾æ¨¡å¼ä¼ é€’ä¸åŒçš„prompt |

**ä½¿ç”¨ä½ç½®**: 
- `src/components/plan-studio/PlanStudioSidebar.tsx` (åº•éƒ¨æŒ‰é’®)
  - Abu: "Ask Agent to refine constraints"
  - Dr.Dre: "Ask Agent to optimize with weights"
  - Neptune: "Ask Agent to apply minimal fixes"

**éœ€è¦ä¿®æ”¹**: 
- å‰ç«¯éœ€è¦æ ¹æ®ä¸åŒè§†å›¾æ¨¡å¼æ„é€ ä¸åŒçš„messageå†…å®¹

---

## 2. è¡Œç¨‹ç®¡ç†æ ¸å¿ƒåŠŸèƒ½

### 2.1 è¯æ®åˆ—è¡¨

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/evidence` | GET | **é«˜** | â³ å¾…å®ç° | è·å–è¡Œç¨‹çš„è¯æ®åˆ—è¡¨ |

**è¯·æ±‚å‚æ•°**:
- `tripId` (è·¯å¾„å‚æ•°): è¡Œç¨‹ID
- `limit` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): è¿”å›æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 50
- `offset` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): åç§»é‡ï¼Œé»˜è®¤ 0
- `day` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): ç­›é€‰ç‰¹å®šå¤©æ•°çš„è¯æ®
- `type` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): ç­›é€‰ç‰¹å®šç±»å‹çš„è¯æ®

**å“åº”æ ¼å¼**: å‚è€ƒ `å¾…æ–°å¢æ¥å£è§„èŒƒ.md` ç¬¬1èŠ‚

**ä½¿ç”¨ä½ç½®**: 
- `src/components/layout/EvidenceDrawer.tsx` (è¯æ®æ ‡ç­¾é¡µ)
- `src/components/plan-studio/PlanStudioSidebar.tsx` (æŸ¥çœ‹è¯æ®æŒ‰é’®)

**å‰ç«¯çŠ¶æ€**: âœ… å‰ç«¯ä»£ç å·²å¯¹æ¥ï¼Œç­‰å¾…åç«¯å®ç°

---

### 2.2 é£é™©é¡¹åˆ—è¡¨

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/risks` | GET | ä¸­ | â³ å¾…å®ç° | è·å–è¡Œç¨‹çš„é£é™©åˆ—è¡¨ |

**æ³¨æ„**: å¯èƒ½éœ€è¦ä» `GET /trips/{tripId}/persona-alerts` ä¸­æå–é£é™©ä¿¡æ¯ï¼Œæˆ–éœ€è¦ç‹¬ç«‹æ¥å£

**ä½¿ç”¨ä½ç½®**: 
- `src/components/layout/EvidenceDrawer.tsx` (é£é™©æ ‡ç­¾é¡µ)

---

## 3. Dashboard é¡µé¢

### 3.1 å…³æ³¨é˜Ÿåˆ—

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/attention-queue` | GET | **é«˜** | â³ å¾…å®ç° | è·å–å…¨å±€å…³æ³¨é˜Ÿåˆ—åˆ—è¡¨ï¼ˆæ¨èï¼‰ |
| `/trips/{tripId}/attention-queue` | GET | ä¸­ | â³ å¾…å®ç° | è·å–ç‰¹å®šè¡Œç¨‹çš„å…³æ³¨é˜Ÿåˆ—ï¼ˆå¯é€‰ï¼‰ |

**è¯·æ±‚å‚æ•°**:
- `limit` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): è¿”å›æ•°é‡é™åˆ¶ï¼Œé»˜è®¤ 20
- `offset` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): åç§»é‡ï¼Œé»˜è®¤ 0
- `severity` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): ç­›é€‰ä¸¥é‡ç¨‹åº¦
- `type` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): ç­›é€‰ç±»å‹
- `tripId` (æŸ¥è¯¢å‚æ•°ï¼Œå¯é€‰): ç­›é€‰ç‰¹å®šè¡Œç¨‹ï¼ˆå¦‚æœä½¿ç”¨å…¨å±€æ¥å£ï¼‰

**å“åº”æ ¼å¼**: å‚è€ƒ `å¾…æ–°å¢æ¥å£è§„èŒƒ.md` ç¬¬2èŠ‚

**ä½¿ç”¨ä½ç½®**: 
- `src/pages/Dashboard.tsx` (Attention Queue å¡ç‰‡)

**å‰ç«¯çŠ¶æ€**: âœ… å‰ç«¯ä»£ç å·²å¯¹æ¥ï¼Œç­‰å¾…åç«¯å®ç°

---

### 3.2 Blockers ç»Ÿè®¡

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/blockers` | GET | ä¸­ | â³ å¾…å®ç° | è·å–æ‰€æœ‰è¡Œç¨‹çš„é˜»å¡é¡¹ç»Ÿè®¡ï¼ˆå¯é€‰ï¼‰ |

**æ³¨æ„**: 
- å·²æœ‰æ¥å£ `GET /readiness/trip/:tripId` å¯ä»¥è·å–å•ä¸ªè¡Œç¨‹çš„blockers
- å¦‚æœéœ€è¦è·¨æ‰€æœ‰è¡Œç¨‹çš„ç»Ÿè®¡ï¼Œå¯èƒ½éœ€è¦æ–°å¢æ­¤æ¥å£
- æˆ–è€…å‰ç«¯å¯ä»¥é€šè¿‡è°ƒç”¨å¤šä¸ªreadinessæ¥å£å¹¶æ±‡æ€»

**ä½¿ç”¨ä½ç½®**: 
- `src/pages/Dashboard.tsx` (Blockers æ˜¾ç¤º)

---

### 3.3 æ¨¡æ¿åˆ—è¡¨ï¼ˆå·²å¯¹æ¥ä½†éœ€ä½¿ç”¨ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/route-directions/templates` | GET | ä½ | âœ… å·²å®ç° | æŸ¥è¯¢è·¯çº¿æ¨¡æ¿åˆ—è¡¨ |

**ä½¿ç”¨ä½ç½®**: 
- `src/pages/Dashboard.tsx` (æ¨¡æ¿åˆ—è¡¨ - å½“å‰ä¸ºç¡¬ç¼–ç )

**éœ€è¦ä¿®æ”¹**: 
- ä½¿ç”¨ `routeDirectionsApi.queryTemplates()` æ›¿æ¢ç¡¬ç¼–ç æ•°æ®

---

## 4. EvidenceDrawer ç»„ä»¶

### 4.1 å†³ç­–æ—¥å¿—ï¼ˆå·²å¯¹æ¥ä½†éœ€ä½¿ç”¨ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/decision-log` | GET | ä¸­ | âœ… å·²å®ç° | è·å–å†³ç­–è®°å½•/é€æ˜æ—¥å¿— |

**ä½¿ç”¨ä½ç½®**: 
- `src/components/layout/EvidenceDrawer.tsx` (å†³ç­–æ—¥å¿—æ ‡ç­¾é¡µ - å½“å‰ä¸ºç¡¬ç¼–ç )

**éœ€è¦ä¿®æ”¹**: 
- ä½¿ç”¨ `tripsApi.getDecisionLog(tripId, limit, offset)` æ›¿æ¢ç¡¬ç¼–ç æ•°æ®

---

### 4.2 é£é™©é¡¹ï¼ˆå‚è€ƒ 2.2ï¼‰

å‚è€ƒ `2.2 é£é™©é¡¹åˆ—è¡¨`

---

## 5. Insights é¡µé¢

### 5.1 å¤ç›˜æŠ¥å‘Šï¼ˆå·²å¯¹æ¥ä½†éœ€ä½¿ç”¨ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/recap` | GET | ä¸­ | âœ… å·²å®ç° | ç”Ÿæˆè¡Œç¨‹å¤ç›˜æŠ¥å‘Š |

**ä½¿ç”¨ä½ç½®**: 
- `src/pages/insights/index.tsx` (å¤ç›˜æŠ¥å‘Š - å½“å‰ä¸ºç¡¬ç¼–ç )

**éœ€è¦ä¿®æ”¹**: 
- ä½¿ç”¨ `tripsApi.getRecap(tripId)` æ›¿æ¢ç¡¬ç¼–ç æ•°æ®
- éœ€è¦ç¡®è®¤å“åº”æ ¼å¼æ˜¯å¦åŒ…å« `robustness`ã€`rhythm`ã€`highlights`ã€`failures` ç­‰å­—æ®µ

---

### 5.2 ç”¨æˆ·åå¥½ï¼ˆå·²å¯¹æ¥ä½†éœ€ä½¿ç”¨ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/users/profile` | GET | ä½ | âœ… å·²å®ç° | è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆåŒ…å«åå¥½è®¾ç½®ï¼‰ |

**ä½¿ç”¨ä½ç½®**: 
- `src/pages/insights/index.tsx` (ç”¨æˆ·åå¥½ - å½“å‰ä¸ºç¡¬ç¼–ç )

**éœ€è¦ä¿®æ”¹**: 
- ä½¿ç”¨ `userApi.getProfile()` è·å–ç”¨æˆ·åå¥½

---

### 5.3 æ¨¡æ¿åˆ—è¡¨ï¼ˆå·²å¯¹æ¥ä½†éœ€ä½¿ç”¨ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/route-directions/templates` | GET | ä½ | âœ… å·²å®ç° | æŸ¥è¯¢è·¯çº¿æ¨¡æ¿åˆ—è¡¨ |

**ä½¿ç”¨ä½ç½®**: 
- `src/pages/insights/index.tsx` (æ¨¡æ¿åˆ—è¡¨ - å½“å‰ä¸ºç¡¬ç¼–ç )

**éœ€è¦ä¿®æ”¹**: 
- ä½¿ç”¨ `routeDirectionsApi.queryTemplates()` æ›¿æ¢ç¡¬ç¼–ç æ•°æ®

---

## 6. å…¶ä»–åŠŸèƒ½

### 6.1 What-If åœºæ™¯å¯¹æ¯”ï¼ˆè§„åˆ’å·¥ä½œå°ï¼‰

| æ¥å£è·¯å¾„ | æ–¹æ³• | ä¼˜å…ˆçº§ | çŠ¶æ€ | è¯´æ˜ |
|---------|------|--------|------|------|
| `/trips/{tripId}/what-if/compare` | POST | ä¸­ | â³ å¾…å®ç° | What-If åœºæ™¯å¯¹æ¯”åˆ†æ |

**ä½¿ç”¨ä½ç½®**: 
- `src/pages/plan-studio/WhatIfTab.tsx` (å½“å‰ä¸ºç¡¬ç¼–ç æ¨¡æ‹Ÿæ•°æ®)

---

## ğŸ“Š æ¥å£ç»Ÿè®¡æ±‡æ€»

### æŒ‰ä¼˜å…ˆçº§åˆ†ç±»

#### P0 ä¼˜å…ˆçº§ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼Œå¿…é¡»å®ç°ï¼‰

| åºå· | æ¥å£è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æ¨¡å— |
|------|---------|------|---------|
| 1 | `/trips/{tripId}/gating-status` | GET | Plan Studio - Abuè§†å›¾ |
| 2 | `/trips/{tripId}/violations` | GET | Plan Studio - Abuè§†å›¾ |
| 3 | `/trips/{tripId}/risk-alerts` | GET | Plan Studio - Abuè§†å›¾ |
| 4 | `/trips/{tripId}/metrics` | GET | Plan Studio - Dr.Dreè§†å›¾ |
| 5 | `/trips/{tripId}/metric-anomalies` | GET | Plan Studio - Dr.Dreè§†å›¾ |
| 6 | `/trips/{tripId}/repairs` | GET | Plan Studio - Neptuneè§†å›¾ |
| 7 | `/trips/{tripId}/repair-progress` | GET | Plan Studio - Neptuneè§†å›¾ |
| 8 | `/trips/{tripId}/repair-suggestions` | GET | Plan Studio - Neptuneè§†å›¾ |

**æ€»è®¡**: 8 ä¸ªæ¥å£

---

#### é«˜ä¼˜å…ˆçº§ï¼ˆé‡è¦åŠŸèƒ½ï¼‰

| åºå· | æ¥å£è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æ¨¡å— |
|------|---------|------|---------|
| 9 | `/trips/{tripId}/evidence` | GET | EvidenceDrawer / Plan Studio |
| 10 | `/trips/attention-queue` | GET | Dashboard |

**æ€»è®¡**: 2 ä¸ªæ¥å£

---

#### ä¸­ä¼˜å…ˆçº§ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰

| åºå· | æ¥å£è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æ¨¡å— |
|------|---------|------|---------|
| 11 | `/trips/{tripId}/risks` | GET | EvidenceDrawer |
| 12 | `/trips/{tripId}/weights` | PUT | Plan Studio - Dr.Dreè§†å›¾ |
| 13 | `/trips/{tripId}/repairs/{repairId}/apply` | POST | Plan Studio - Neptuneè§†å›¾ |
| 14 | `/trips/{tripId}/repairs/apply-all` | POST | Plan Studio - Neptuneè§†å›¾ |
| 15 | `/trips/{tripId}/what-if/compare` | POST | Plan Studio - WhatIf |
| 16 | `/trips/blockers` | GET | Dashboardï¼ˆå¯é€‰ï¼‰ |

**æ€»è®¡**: 6 ä¸ªæ¥å£

---

#### ä½ä¼˜å…ˆçº§ï¼ˆä¼˜åŒ–åŠŸèƒ½ï¼‰

| åºå· | æ¥å£è·¯å¾„ | æ–¹æ³• | åŠŸèƒ½æ¨¡å— | çŠ¶æ€ |
|------|---------|------|---------|------|
| 17 | `/route-directions/templates` | GET | Dashboard / Insights | âœ… å·²å®ç°ï¼ˆéœ€ä½¿ç”¨ï¼‰ |
| 18 | `/users/profile` | GET | Insights | âœ… å·²å®ç°ï¼ˆéœ€ä½¿ç”¨ï¼‰ |
| 19 | `/trips/{tripId}/decision-log` | GET | EvidenceDrawer | âœ… å·²å®ç°ï¼ˆéœ€ä½¿ç”¨ï¼‰ |
| 20 | `/trips/{tripId}/recap` | GET | Insights | âœ… å·²å®ç°ï¼ˆéœ€ä½¿ç”¨ï¼‰ |

**æ€»è®¡**: 4 ä¸ªæ¥å£ï¼ˆå·²å®ç°ï¼Œå‰ç«¯éœ€å¯¹æ¥ä½¿ç”¨ï¼‰

---

### æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç±»

| åŠŸèƒ½æ¨¡å— | P0 | é«˜ | ä¸­ | ä½ | å°è®¡ |
|---------|----|----|----|----|------|
| Plan Studio - Abuè§†å›¾ | 3 | 0 | 0 | 0 | 3 |
| Plan Studio - Dr.Dreè§†å›¾ | 2 | 0 | 1 | 0 | 3 |
| Plan Studio - Neptuneè§†å›¾ | 3 | 0 | 2 | 0 | 5 |
| Plan Studio - å…¶ä»– | 0 | 1 | 1 | 0 | 2 |
| EvidenceDrawer | 0 | 1 | 1 | 1 | 3 |
| Dashboard | 0 | 1 | 1 | 1 | 3 |
| Insights | 0 | 0 | 0 | 3 | 3 |
| **æ€»è®¡** | **8** | **3** | **6** | **5** | **22** |

---

## ğŸ“ æ¥å£å®ç°å»ºè®®

### å®ç°é¡ºåºå»ºè®®

1. **ç¬¬ä¸€é˜¶æ®µï¼ˆP0 - æ ¸å¿ƒåŠŸèƒ½ï¼‰**:
   - Plan Studio ä¸‰è§†å›¾çš„æ ¸å¿ƒæ•°æ®æ¥å£ï¼ˆ8ä¸ªï¼‰
   - è¿™æ˜¯è§„åˆ’å·¥ä½œå°çš„åŸºç¡€åŠŸèƒ½ï¼Œå¿…é¡»ä¼˜å…ˆå®ç°

2. **ç¬¬äºŒé˜¶æ®µï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰**:
   - Evidence æ¥å£
   - Attention Queue æ¥å£
   - è¿™ä¸¤ä¸ªæ¥å£å½±å“å¤šä¸ªé¡µé¢çš„æ ¸å¿ƒåŠŸèƒ½

3. **ç¬¬ä¸‰é˜¶æ®µï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰**:
   - ä¿®å¤åº”ç”¨çš„æ¥å£
   - What-If å¯¹æ¯”æ¥å£
   - å…¶ä»–å¢å¼ºåŠŸèƒ½æ¥å£

4. **ç¬¬å››é˜¶æ®µï¼ˆä½ä¼˜å…ˆçº§ï¼‰**:
   - ä½¿ç”¨å·²æœ‰æ¥å£æ›¿æ¢ç¡¬ç¼–ç 
   - ä¼˜åŒ–å’Œå¢å¼ºåŠŸèƒ½

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- `å¾…æ–°å¢æ¥å£è§„èŒƒ.md` - è¯¦ç»†çš„æ¥å£è§„èŒƒï¼ˆè¯æ®ä¸å…³æ³¨é˜Ÿåˆ—ï¼‰
- `è§„åˆ’å·¥ä½œå°ä¸‰è§†å›¾å®ç°-æ€»ç»“æŠ¥å‘Š.md` - Plan Studio ä¸‰è§†å›¾å®ç°è¯¦æƒ…
- `è¡Œç¨‹ç®¡ç†ç¡¬ç¼–ç æ£€æŸ¥æ¸…å•.md` - è¡Œç¨‹ç®¡ç†ç›¸å…³ç¡¬ç¼–ç æ¸…å•
- `è¯æ®ä¸å…³æ³¨é˜Ÿåˆ—-å‰ç«¯å¯¹æ¥å®Œæˆæ¸…å•.md` - è¯æ®ä¸å…³æ³¨é˜Ÿåˆ—å‰ç«¯å¯¹æ¥çŠ¶æ€
- `APIå¯¹æ¥æ¸…å•.md` - å‰ç«¯å·²å¯¹æ¥çš„æ‰€æœ‰æ¥å£æ¸…å•

---

## âœ… æ£€æŸ¥æ¸…å•

### åç«¯å¾…å®ç°æ¥å£
- [ ] P0ä¼˜å…ˆçº§æ¥å£ï¼ˆ8ä¸ªï¼‰
- [ ] é«˜ä¼˜å…ˆçº§æ¥å£ï¼ˆ2ä¸ªï¼‰
- [ ] ä¸­ä¼˜å…ˆçº§æ¥å£ï¼ˆ6ä¸ªï¼‰

### å‰ç«¯å¾…å¯¹æ¥æ¥å£
- [ ] ä½¿ç”¨å·²æœ‰æ¥å£æ›¿æ¢ç¡¬ç¼–ç ï¼ˆ4ä¸ªï¼‰
- [ ] Plan Studio ä¸‰è§†å›¾æ•°æ®å¯¹æ¥
- [ ] Dashboard æ¨¡æ¿åˆ—è¡¨å¯¹æ¥
- [ ] Insights é¡µé¢æ•°æ®å¯¹æ¥
- [ ] EvidenceDrawer å†³ç­–æ—¥å¿—å¯¹æ¥

---

**æ–‡æ¡£çŠ¶æ€**: å®Œæ•´  
**æœ€åæ›´æ–°**: 2025-01-01

