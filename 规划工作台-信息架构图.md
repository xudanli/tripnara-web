# è§„åˆ’å·¥ä½œå° - ä¿¡æ¯æ¶æ„å›¾

**ç”Ÿæˆæ—¶é—´**: 2025-01-XX  
**æ–‡ä»¶**: `src/pages/plan-studio/index.tsx`

---

## ğŸ“‹ ç›®å½•

1. [æ•´ä½“æ¶æ„](#æ•´ä½“æ¶æ„)
2. [é¡µé¢ç»“æ„](#é¡µé¢ç»“æ„)
3. [æ•°æ®æµæ¶æ„](#æ•°æ®æµæ¶æ„)
4. [ç»„ä»¶å±‚çº§ç»“æ„](#ç»„ä»¶å±‚çº§ç»“æ„)
5. [æ ‡ç­¾é¡µæ¶æ„](#æ ‡ç­¾é¡µæ¶æ„)
6. [æ¥å£è°ƒç”¨æ¶æ„](#æ¥å£è°ƒç”¨æ¶æ„)
7. [çŠ¶æ€ç®¡ç†æ¶æ„](#çŠ¶æ€ç®¡ç†æ¶æ„)
8. [äº¤äº’æµç¨‹æ¶æ„](#äº¤äº’æµç¨‹æ¶æ„)

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è§„åˆ’å·¥ä½œå° (PlanStudioPage)                     â”‚
â”‚                    src/pages/plan-studio/index.tsx                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  é¡¶éƒ¨åŒºåŸŸ â”‚        â”‚   ä¸»å†…å®¹åŒº    â”‚      â”‚  å³ä¾§æ       â”‚
  â”‚ (Header) â”‚        â”‚ (Main Area)  â”‚      â”‚ (Sidebar)   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“„ é¡µé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          è§„åˆ’å·¥ä½œå°å¸ƒå±€                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  é¡¶éƒ¨æ“ä½œæ  (Top Bar)                                             â”‚  â”‚
â”‚  â”‚  â”œâ”€ æ ‡é¢˜ï¼š"è§„åˆ’å·¥ä½œå°"                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ å‰¯æ ‡é¢˜                                                        â”‚  â”‚
â”‚  â”‚  â””â”€ PersonaModeToggle (è§†å›¾åˆ‡æ¢: Abu/Dr.Dre/Neptune)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ ‡ç­¾é¡µå¯¼èˆª (Tabs Navigation)                                    â”‚  â”‚
â”‚  â”‚  â”œâ”€ "æ„å›¾" (Intent)                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€ "åœ°ç‚¹" (Places)                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€ "æ—¥ç¨‹" (Schedule)                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ "ä¼˜åŒ–" (Optimize)                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€ "å‡è®¾åˆ†æ" (What-If)                                         â”‚  â”‚
â”‚  â”‚  â””â”€ "é¢„è®¢" (Bookings)                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                          â”‚                                       â”‚  â”‚
â”‚  â”‚   ä¸»å†…å®¹åŒºåŸŸ              â”‚        å³ä¾§æ åŒºåŸŸ                     â”‚  â”‚
â”‚  â”‚   (col-span-8)           â”‚        (col-span-4)                   â”‚  â”‚
â”‚  â”‚                          â”‚                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ æ ‡ç­¾é¡µå†…å®¹          â”‚  â”‚  â”‚  PlanStudioSidebar             â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ (TabsContent)      â”‚  â”‚  â”‚  â”œâ”€ å‡†å¤‡åº¦æ‘˜è¦å¡ç‰‡              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚  â”‚  â”œâ”€ äººæ ¼æé†’å¡ç‰‡                â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  æ ¹æ® activeTab    â”‚  â”‚  â”‚  â”œâ”€ æŒ‡æ ‡å¡ç‰‡                   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  æ˜¾ç¤ºä¸åŒæ ‡ç­¾é¡µï¼š   â”‚  â”‚  â”‚  â””â”€ æ“ä½œæŒ‰é’®                   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ IntentTab       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚    (æ„å›¾é…ç½®)       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ PlacesTab       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚    (åœ°ç‚¹æœç´¢)       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ ScheduleTab    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚    (æ—¥ç¨‹å®‰æ’)       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ OptimizeTab    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚    (è·¯çº¿ä¼˜åŒ–)       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ WhatIfTab      â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚    (å‡è®¾åˆ†æ)       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚  â€¢ BookingsTab    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚    (é¢„è®¢ç®¡ç†)       â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                       â”‚  â”‚
â”‚  â”‚                          â”‚                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¼¹çª—ç»„ä»¶ (Modals/Drawers)                                        â”‚  â”‚
â”‚  â”‚  â”œâ”€ WelcomeModal (æ¬¢è¿å¼•å¯¼)                                       â”‚  â”‚
â”‚  â”‚  â”œâ”€ SpotlightTour (åŠŸèƒ½å¼•å¯¼)                                      â”‚  â”‚
â”‚  â”‚  â””â”€ ReadinessDrawer (å‡†å¤‡åº¦æŠ½å±‰)                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ æ•°æ®æµæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®åŠ è½½æµç¨‹                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é¡µé¢åˆå§‹åŒ– (useEffect)
    â”‚
    â–¼
checkTripsAndTripId()
    â”‚
    â”œâ”€ GET /trips (è·å–æ‰€æœ‰è¡Œç¨‹)
    â”‚  â””â”€ hasTrips: boolean
    â”‚
    â””â”€ GET /trips/:id (éªŒè¯tripId)
       â””â”€ tripExists: boolean
              â”‚
              â–¼
        æ¡ä»¶æ¸²æŸ“
              â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
        â”‚           â”‚
        â–¼           â–¼
   WelcomeModal  æ­£å¸¸é¡µé¢
   (æ— è¡Œç¨‹æ—¶)    (æœ‰è¡Œç¨‹æ—¶)
        â”‚           â”‚
        â”‚           â”œâ”€ IntentTab
        â”‚           â”‚  â””â”€ GET /trips/:id
        â”‚           â”‚  â””â”€ GET /trips/:id/intent
        â”‚           â”‚
        â”‚           â”œâ”€ PlacesTab
        â”‚           â”‚  â””â”€ GET /trips/:id
        â”‚           â”‚  â””â”€ GET /places/search
        â”‚           â”‚  â””â”€ GET /places/nearby
        â”‚           â”‚
        â”‚           â”œâ”€ ScheduleTab
        â”‚           â”‚  â””â”€ GET /trips/:id
        â”‚           â”‚  â””â”€ GET /trips/:id/schedule
        â”‚           â”‚  â””â”€ GET /trips/:id/metrics
        â”‚           â”‚  â””â”€ GET /trips/:id/conflicts
        â”‚           â”‚
        â”‚           â”œâ”€ OptimizeTab
        â”‚           â”‚  â””â”€ GET /trips/:id
        â”‚           â”‚  â””â”€ POST /itinerary-optimization/optimize
        â”‚           â”‚
        â”‚           â”œâ”€ WhatIfTab
        â”‚           â”‚  â””â”€ GET /trips/:id
        â”‚           â”‚
        â”‚           â””â”€ BookingsTab
        â”‚              â””â”€ GET /trips/:id
        â”‚
        â””â”€ PlanStudioSidebar
           â”œâ”€ GET /trips/:id
           â”œâ”€ GET /trips/:id/persona-alerts
           â”œâ”€ GET /trips/:id/metrics
           â”œâ”€ GET /trips/:id/intent
           â””â”€ GET /readiness/trips/:id
```

---

## ğŸ§© ç»„ä»¶å±‚çº§ç»“æ„

```
PlanStudioPage (src/pages/plan-studio/index.tsx)
â”‚
â”œâ”€ çŠ¶æ€ç®¡ç†
â”‚  â”œâ”€ tripId: string | null (æ¥è‡ª URL searchParams)
â”‚  â”œâ”€ activeTab: string ('intent' | 'places' | 'schedule' | 'optimize' | 'what-if' | 'bookings')
â”‚  â”œâ”€ personaMode: PersonaMode ('abu' | 'dre' | 'neptune')
â”‚  â”œâ”€ loading: boolean
â”‚  â”œâ”€ hasTrips: boolean
â”‚  â”œâ”€ tripExists: boolean
â”‚  â”œâ”€ showWelcomeModal: boolean
â”‚  â”œâ”€ showTour: boolean
â”‚  â”œâ”€ refreshKey: number (ç”¨äºè§¦å‘å­ç»„ä»¶åˆ·æ–°)
â”‚  â”œâ”€ readinessDrawerOpen: boolean
â”‚  â””â”€ highlightFindingId: string | undefined
â”‚
â”œâ”€ é¡¶éƒ¨åŒºåŸŸ
â”‚  â”œâ”€ æ ‡é¢˜å’Œå‰¯æ ‡é¢˜
â”‚  â””â”€ PersonaModeToggle
â”‚     â””â”€ è§†å›¾åˆ‡æ¢ (Abu/Dr.Dre/Neptune)
â”‚
â”œâ”€ ä¸»å†…å®¹åŒºåŸŸ
â”‚  â”‚
â”‚  â”œâ”€ Tabs (æ ‡ç­¾é¡µå¯¼èˆª)
â”‚  â”‚  â”œâ”€ "æ„å›¾" (IntentTab)
â”‚  â”‚  â”œâ”€ "åœ°ç‚¹" (PlacesTab)
â”‚  â”‚  â”œâ”€ "æ—¥ç¨‹" (ScheduleTab)
â”‚  â”‚  â”œâ”€ "ä¼˜åŒ–" (OptimizeTab)
â”‚  â”‚  â”œâ”€ "å‡è®¾åˆ†æ" (WhatIfTab)
â”‚  â”‚  â””â”€ "é¢„è®¢" (BookingsTab)
â”‚  â”‚
â”‚  â””â”€ TabsContent
â”‚     â”‚
â”‚     â”œâ”€ IntentTab
â”‚     â”‚  â”œâ”€ Trip DNA é…ç½®
â”‚     â”‚  â”‚  â”œâ”€ èŠ‚å¥é€‰æ‹© (relaxed/standard/tight)
â”‚     â”‚  â”‚  â””â”€ åå¥½é€‰æ‹© (å¤šé€‰)
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Hard Constraints
â”‚     â”‚  â”‚  â”œâ”€ æ¯æ—¥æ­¥è¡Œé™åˆ¶
â”‚     â”‚  â”‚  â”œâ”€ æ—©èµ·è€…/å¤œçŒ«å­
â”‚     â”‚  â”‚  â”œâ”€ å¿…é¡»åœ°ç‚¹ (Must Places)
â”‚     â”‚  â”‚  â””â”€ é¿å…åœ°ç‚¹ (Avoid Places)
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ é¢„ç®—è®¾ç½®
â”‚     â”‚  â””â”€ è§„åˆ’ç­–ç•¥ (safe/experience/challenge)
â”‚     â”‚
â”‚     â”œâ”€ PlacesTab
â”‚     â”‚  â”œâ”€ æœç´¢åŒºåŸŸ
â”‚     â”‚  â”‚  â”œâ”€ æœç´¢æ¨¡å¼åˆ‡æ¢ (search/nearby/recommend)
â”‚     â”‚  â”‚  â”œâ”€ æœç´¢è¾“å…¥æ¡†
â”‚     â”‚  â”‚  â”œâ”€ åˆ†ç±»ç­›é€‰
â”‚     â”‚  â”‚  â””â”€ æœç´¢æŒ‰é’®
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ æœç´¢ç»“æœåˆ—è¡¨
â”‚     â”‚  â”‚  â”œâ”€ PlaceCard[] (åœ°ç‚¹å¡ç‰‡)
â”‚     â”‚  â”‚  â”‚  â”œâ”€ åœ°ç‚¹åç§°
â”‚     â”‚  â”‚  â”‚  â”œâ”€ è·ç¦»/è¯„åˆ†
â”‚     â”‚  â”‚  â”‚  â”œâ”€ è¯æ®æ ‡ç­¾ (Evidence Tags)
â”‚     â”‚  â”‚  â”‚  â””â”€ "åŠ å…¥" æŒ‰é’®
â”‚     â”‚  â”‚  â”‚
â”‚     â”‚  â””â”€ æ·»åŠ åœ°ç‚¹å¯¹è¯æ¡†
â”‚     â”‚     â”œâ”€ é€‰æ‹©æ—¥æœŸ
â”‚     â”‚     â””â”€ ç¡®è®¤æ·»åŠ 
â”‚     â”‚
â”‚     â”œâ”€ ScheduleTab
â”‚     â”‚  â”œâ”€ æ—¥ç¨‹æ—¶é—´çº¿
â”‚     â”‚  â”‚  â”œâ”€ Day 1 ~ Day N
â”‚     â”‚  â”‚  â”‚  â”œâ”€ æ—¥æœŸæ ‡é¢˜
â”‚     â”‚  â”‚  â”‚  â”œâ”€ ItineraryItemRow[] (å¯æ‹–æ‹½)
â”‚     â”‚  â”‚  â”‚  â”‚  â”œâ”€ æ—¶é—´çª—å£
â”‚     â”‚  â”‚  â”‚  â”‚  â”œâ”€ åœ°ç‚¹åç§°
â”‚     â”‚  â”‚  â”‚  â”‚  â”œâ”€ æ“ä½œèœå• (ç¼–è¾‘/æ›¿æ¢/ç§»åŠ¨/åˆ é™¤)
â”‚     â”‚  â”‚  â”‚  â”‚  â””â”€ å†²çªæ ‡è®°
â”‚     â”‚  â”‚  â”‚  â”‚
â”‚     â”‚  â”‚  â”‚  â””â”€ æ·»åŠ è¡Œç¨‹é¡¹æŒ‰é’®
â”‚     â”‚  â”‚  â”‚
â”‚     â”‚  â”œâ”€ å†²çªåˆ—è¡¨å¡ç‰‡
â”‚     â”‚  â”‚  â”œâ”€ å†²çªé¡¹åˆ—è¡¨
â”‚     â”‚  â”‚  â”‚  â”œâ”€ å†²çªç±»å‹
â”‚     â”‚  â”‚  â”‚  â”œâ”€ æ¶‰åŠè¡Œç¨‹é¡¹
â”‚     â”‚  â”‚  â”‚  â””â”€ "ä¿®å¤" æŒ‰é’®
â”‚     â”‚  â”‚  â”‚
â”‚     â”‚  â”œâ”€ æ“ä½œæŒ‰é’®ç»„
â”‚     â”‚  â”‚  â”œâ”€ "è¿è¡Œä¼˜åŒ–" (Run Optimize)
â”‚     â”‚  â”‚  â”œâ”€ "æ·»åŠ ç¼“å†²" (Add Buffers)
â”‚     â”‚  â”‚  â””â”€ "æŸ¥çœ‹è¯¦æƒ…" (View Details)
â”‚     â”‚  â”‚
â”‚     â”‚  â””â”€ å¼¹çª—ç»„ä»¶
â”‚     â”‚     â”œâ”€ EditItineraryItemDialog
â”‚     â”‚     â”œâ”€ ReplaceItineraryItemDialog
â”‚     â”‚     â”œâ”€ MoveItemDialog
â”‚     â”‚     â””â”€ DeleteItemAlertDialog
â”‚     â”‚
â”‚     â”œâ”€ OptimizeTab
â”‚     â”‚  â”œâ”€ ä¼˜åŒ–å‰/åå¯¹æ¯”
â”‚     â”‚  â”‚  â”œâ”€ Before è§†å›¾
â”‚     â”‚  â”‚  â””â”€ After è§†å›¾
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ å˜æ›´åˆ—è¡¨
â”‚     â”‚  â”‚  â”œâ”€ å˜æ›´é¡¹ (Change Item)
â”‚     â”‚  â”‚  â”‚  â”œâ”€ å˜æ›´ç±»å‹
â”‚     â”‚  â”‚  â”‚  â”œâ”€ åŸå› ç  (Reason Code)
â”‚     â”‚  â”‚  â”‚  â””â”€ è¯æ®é“¾æ¥
â”‚     â”‚  â”‚  â”‚
â”‚     â”‚  â”œâ”€ ä¼˜åŒ–é…ç½®
â”‚     â”‚  â”‚  â”œâ”€ ä¼˜åŒ–ç›®æ ‡é€‰æ‹©
â”‚     â”‚  â”‚  â””â”€ ä¼˜åŒ–å‚æ•°è®¾ç½®
â”‚     â”‚  â”‚
â”‚     â”‚  â””â”€ "åº”ç”¨ä¼˜åŒ–" æŒ‰é’®
â”‚     â”‚
â”‚     â”œâ”€ WhatIfTab
â”‚     â”‚  â”œâ”€ å‡è®¾åœºæ™¯é…ç½®
â”‚     â”‚  â”‚  â”œâ”€ åœºæ™¯é€‰æ‹©
â”‚     â”‚  â”‚  â””â”€ å‚æ•°è°ƒæ•´
â”‚     â”‚  â”‚
â”‚     â”‚  â””â”€ ç»“æœé¢„è§ˆ
â”‚     â”‚
â”‚     â””â”€ BookingsTab
â”‚        â”œâ”€ é¢„è®¢åˆ—è¡¨
â”‚        â”‚  â”œâ”€ é¢„è®¢é¡¹å¡ç‰‡
â”‚        â”‚  â”‚  â”œâ”€ é¢„è®¢ä¿¡æ¯
â”‚        â”‚  â”‚  â”œâ”€ çŠ¶æ€æ ‡è®°
â”‚        â”‚  â”‚  â””â”€ æ“ä½œæŒ‰é’®
â”‚        â”‚  â”‚
â”‚        â””â”€ æ·»åŠ é¢„è®¢æŒ‰é’®
â”‚
â”œâ”€ å³ä¾§æ  (col-span-4)
â”‚  â”‚
â”‚  â””â”€ PlanStudioSidebar
â”‚     â”œâ”€ å‡†å¤‡åº¦æ‘˜è¦å¡ç‰‡
â”‚     â”‚  â”œâ”€ é˜»å¡é¡¹æ•°é‡ (Blockers)
â”‚     â”‚  â”œâ”€ å¿…é¡»é¡¹æ•°é‡ (Must)
â”‚     â”‚  â”œâ”€ åº”è¯¥é¡¹æ•°é‡ (Should)
â”‚     â”‚  â”œâ”€ å¯é€‰é¡¹æ•°é‡ (Optional)
â”‚     â”‚  â””â”€ "æŸ¥çœ‹è¯¦æƒ…" æŒ‰é’® â†’ ReadinessDrawer
â”‚     â”‚
â”‚     â”œâ”€ äººæ ¼æé†’å¡ç‰‡
â”‚     â”‚  â”œâ”€ å½“å‰äººæ ¼è¿‡æ»¤ (Abu/Dr.Dre/Neptune)
â”‚     â”‚  â”œâ”€ AlertCard[] (æé†’å¡ç‰‡åˆ—è¡¨)
â”‚     â”‚  â”‚  â”œâ”€ æé†’æ ‡é¢˜
â”‚     â”‚  â”‚  â”œâ”€ æé†’æ¶ˆæ¯
â”‚     â”‚  â”‚  â””â”€ æ“ä½œæŒ‰é’®
â”‚     â”‚  â”‚
â”‚     â”‚  â””â”€ "æŸ¥çœ‹å…¨éƒ¨" é“¾æ¥
â”‚     â”‚
â”‚     â”œâ”€ æŒ‡æ ‡å¡ç‰‡
â”‚     â”‚  â”œâ”€ æ€»æ—¶é•¿
â”‚     â”‚  â”œâ”€ æ€»è·ç¦»
â”‚     â”‚  â”œâ”€ æ€»é¢„ç®—
â”‚     â”‚  â””â”€ å…¶ä»–æŒ‡æ ‡
â”‚     â”‚
â”‚     â””â”€ æ“ä½œæŒ‰é’®
â”‚        â”œâ”€ "éªŒè¯å®‰å…¨" (Validate Safety)
â”‚        â”œâ”€ "è°ƒæ•´èŠ‚å¥" (Adjust Pacing)
â”‚        â””â”€ "åº”ç”¨ä¿®å¤" (Apply Repairs)
â”‚
â””â”€ å¼¹çª—ç»„ä»¶
   â”œâ”€ WelcomeModal (æ¬¢è¿å¼•å¯¼)
   â”‚  â”œâ”€ ä½“éªŒç±»å‹é€‰æ‹©
   â”‚  â””â”€ å®Œæˆå›è°ƒ
   â”‚
   â”œâ”€ SpotlightTour (åŠŸèƒ½å¼•å¯¼)
   â”‚  â”œâ”€ æ­¥éª¤é…ç½® (TourStep[])
   â”‚  â””â”€ å®Œæˆå›è°ƒ
   â”‚
   â””â”€ ReadinessDrawer (å‡†å¤‡åº¦æŠ½å±‰)
      â”œâ”€ å‡†å¤‡åº¦è¯¦æƒ…
      â”œâ”€ é£é™©åˆ—è¡¨
      â””â”€ ä¿®å¤å»ºè®®
```

---

## ğŸ·ï¸ æ ‡ç­¾é¡µæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ ‡ç­¾é¡µåˆ‡æ¢æµç¨‹                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”¨æˆ·æ“ä½œ
    â”‚
    â–¼
TabsList (æ ‡ç­¾é¡µå¯¼èˆª)
    â”‚
    â”œâ”€ ç‚¹å‡» "æ„å›¾"
    â”‚  â””â”€ setActiveTab('intent')
    â”‚     â””â”€ æ›´æ–° URL searchParams
    â”‚        â””â”€ å®Œæˆ onboarding step: 'style'
    â”‚
    â”œâ”€ ç‚¹å‡» "åœ°ç‚¹"
    â”‚  â””â”€ setActiveTab('places')
    â”‚     â””â”€ æ›´æ–° URL searchParams
    â”‚        â””â”€ å®Œæˆ onboarding step: 'places'
    â”‚
    â”œâ”€ ç‚¹å‡» "æ—¥ç¨‹"
    â”‚  â””â”€ setActiveTab('schedule')
    â”‚     â””â”€ æ›´æ–° URL searchParams
    â”‚        â””â”€ å®Œæˆ onboarding step: 'schedule'
    â”‚
    â”œâ”€ ç‚¹å‡» "ä¼˜åŒ–"
    â”‚  â””â”€ setActiveTab('optimize')
    â”‚     â”œâ”€ æ›´æ–° URL searchParams
    â”‚     â”œâ”€ å®Œæˆ onboarding step: 'optimize'
    â”‚     â””â”€ è‡ªåŠ¨åˆ‡æ¢ personaMode åˆ° 'dre' (å¦‚æœå½“å‰ä¸æ˜¯)
    â”‚
    â”œâ”€ ç‚¹å‡» "å‡è®¾åˆ†æ"
    â”‚  â””â”€ setActiveTab('what-if')
    â”‚     â””â”€ æ›´æ–° URL searchParams
    â”‚
    â””â”€ ç‚¹å‡» "é¢„è®¢"
       â””â”€ setActiveTab('bookings')
          â””â”€ æ›´æ–° URL searchParams
              â”‚
              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  activeTab çŠ¶æ€   â”‚
        â”‚  æ›´æ–°è§¦å‘é‡æ¸²æŸ“   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  æ¡ä»¶æ¸²æŸ“ (TabsContent)                  â”‚
        â”‚                                         â”‚
        â”‚  {activeTab === 'intent' && <IntentTab />}â”‚
        â”‚  {activeTab === 'places' && <PlacesTab />}â”‚
        â”‚  {activeTab === 'schedule' && <ScheduleTab />}â”‚
        â”‚  {activeTab === 'optimize' && <OptimizeTab />}â”‚
        â”‚  {activeTab === 'what-if' && <WhatIfTab />}â”‚
        â”‚  {activeTab === 'bookings' && <BookingsTab />}â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚          â”‚           â”‚           â”‚
        â–¼           â–¼          â–¼           â–¼           â–¼
    IntentTab  PlacesTab ScheduleTab OptimizeTab WhatIfTab BookingsTab
    (æ„å›¾é…ç½®)  (åœ°ç‚¹æœç´¢)  (æ—¥ç¨‹å®‰æ’)  (è·¯çº¿ä¼˜åŒ–)  (å‡è®¾åˆ†æ) (é¢„è®¢ç®¡ç†)
```

---

## ğŸŒ æ¥å£è°ƒç”¨æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ¥å£è°ƒç”¨å…³ç³»å›¾                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PlanStudioPage
    â”‚
    â”œâ”€ åˆå§‹åŒ–æ£€æŸ¥
    â”‚  â”œâ”€ GET /trips
    â”‚  â”‚  â””â”€ æ£€æŸ¥æ˜¯å¦æœ‰è¡Œç¨‹æ•°æ®
    â”‚  â”‚
    â”‚  â””â”€ GET /trips/:id
    â”‚     â””â”€ éªŒè¯ tripId æ˜¯å¦æœ‰æ•ˆ
    â”‚
    â”œâ”€ IntentTab
    â”‚  â”‚
    â”‚  â”œâ”€ æ•°æ®åŠ è½½
    â”‚  â”‚  â”œâ”€ GET /trips/:id
    â”‚  â”‚  â”‚  â””â”€ trip: TripDetail
    â”‚  â”‚  â”‚
    â”‚  â”‚  â””â”€ GET /trips/:id/intent
    â”‚  â”‚     â””â”€ intent: IntentResponse
    â”‚  â”‚        â”œâ”€ pacingConfig
    â”‚  â”‚        â”œâ”€ preferences
    â”‚  â”‚        â”œâ”€ constraints
    â”‚  â”‚        â””â”€ planningPolicy
    â”‚  â”‚
    â”‚  â”œâ”€ åœ°ç‚¹æœç´¢
    â”‚  â”‚  â””â”€ GET /places/search?q={query}
    â”‚  â”‚     â””â”€ PlaceWithDistance[]
    â”‚  â”‚
    â”‚  â””â”€ ä¿å­˜é…ç½®
    â”‚     â”œâ”€ PUT /trips/:id (æ›´æ–°åŸºç¡€ä¿¡æ¯)
    â”‚     â””â”€ PUT /trips/:id/intent (æ›´æ–°æ„å›¾é…ç½®)
    â”‚
    â”œâ”€ PlacesTab
    â”‚  â”‚
    â”‚  â”œâ”€ æ•°æ®åŠ è½½
    â”‚  â”‚  â””â”€ GET /trips/:id
    â”‚  â”‚     â””â”€ trip: TripDetail
    â”‚  â”‚
    â”‚  â”œâ”€ åœ°ç‚¹æœç´¢
    â”‚  â”‚  â”œâ”€ GET /places/search?q={query}
    â”‚  â”‚  â”‚  â””â”€ PlaceWithDistance[]
    â”‚  â”‚  â”‚
    â”‚  â”‚  â”œâ”€ GET /places/nearby?lat={lat}&lng={lng}
    â”‚  â”‚  â”‚  â””â”€ PlaceWithDistance[]
    â”‚  â”‚  â”‚
    â”‚  â”‚  â””â”€ GET /places/recommend?tripId={tripId}
    â”‚  â”‚     â””â”€ PlaceWithDistance[]
    â”‚  â”‚
    â”‚  â””â”€ æ·»åŠ åœ°ç‚¹
    â”‚     â””â”€ POST /trips/:id/items
    â”‚        â””â”€ CreateItineraryItemRequest
    â”‚           â”œâ”€ placeId
    â”‚           â”œâ”€ dayId
    â”‚           â””â”€ metadata
    â”‚
    â”œâ”€ ScheduleTab
    â”‚  â”‚
    â”‚  â”œâ”€ æ•°æ®åŠ è½½
    â”‚  â”‚  â”œâ”€ GET /trips/:id
    â”‚  â”‚  â”‚  â””â”€ trip: TripDetail
    â”‚  â”‚  â”‚
    â”‚  â”‚  â”œâ”€ GET /trips/:id/schedule
    â”‚  â”‚  â”‚  â””â”€ ScheduleResponse[] (æŒ‰æ—¥æœŸåˆ†ç»„)
    â”‚  â”‚  â”‚
    â”‚  â”‚  â”œâ”€ GET /trips/:id/metrics
    â”‚  â”‚  â”‚  â””â”€ TripMetricsResponse
    â”‚  â”‚  â”‚
    â”‚  â”‚  â””â”€ GET /trips/:id/conflicts
    â”‚  â”‚     â””â”€ PlanStudioConflict[]
    â”‚  â”‚
    â”‚  â”œâ”€ æ—¥ç¨‹æ“ä½œ
    â”‚  â”‚  â”œâ”€ PUT /trips/:id/items/:itemId (ç¼–è¾‘è¡Œç¨‹é¡¹)
    â”‚  â”‚  â”œâ”€ POST /trips/:id/items/:itemId/replace (æ›¿æ¢è¡Œç¨‹é¡¹)
    â”‚  â”‚  â”œâ”€ PUT /trips/:id/items/:itemId/move (ç§»åŠ¨è¡Œç¨‹é¡¹)
    â”‚  â”‚  â””â”€ DELETE /trips/:id/items/:itemId (åˆ é™¤è¡Œç¨‹é¡¹)
    â”‚  â”‚
    â”‚  â””â”€ ä¼˜åŒ–æ“ä½œ
    â”‚     â”œâ”€ POST /itinerary-optimization/optimize
    â”‚     â”‚  â””â”€ OptimizeRouteRequest
    â”‚     â”‚     â”œâ”€ placeIds
    â”‚     â”‚     â””â”€ config
    â”‚     â”‚
    â”‚     â””â”€ POST /trips/:id/optimize/apply
    â”‚        â””â”€ åº”ç”¨ä¼˜åŒ–ç»“æœ
    â”‚
    â”œâ”€ OptimizeTab
    â”‚  â”‚
    â”‚  â”œâ”€ æ•°æ®åŠ è½½
    â”‚  â”‚  â””â”€ GET /trips/:id
    â”‚  â”‚     â””â”€ trip: TripDetail
    â”‚  â”‚
    â”‚  â””â”€ ä¼˜åŒ–æ“ä½œ
    â”‚     â””â”€ POST /itinerary-optimization/optimize
    â”‚        â””â”€ OptimizeRouteRequest
    â”‚           â”œâ”€ placeIds: number[]
    â”‚           â””â”€ config: OptimizationConfig
    â”‚              â”œâ”€ date
    â”‚              â”œâ”€ startTime
    â”‚              â”œâ”€ endTime
    â”‚              â””â”€ pacingFactor
    â”‚
    â”œâ”€ WhatIfTab
    â”‚  â”‚
    â”‚  â”œâ”€ æ•°æ®åŠ è½½
    â”‚  â”‚  â””â”€ GET /trips/:id
    â”‚  â”‚     â””â”€ trip: TripDetail
    â”‚  â”‚
    â”‚  â””â”€ å‡è®¾åˆ†æ
    â”‚     â””â”€ POST /trips/:id/what-if
    â”‚        â””â”€ WhatIfRequest
    â”‚
    â”œâ”€ BookingsTab
    â”‚  â”‚
    â”‚  â”œâ”€ æ•°æ®åŠ è½½
    â”‚  â”‚  â””â”€ GET /trips/:id
    â”‚  â”‚     â””â”€ trip: TripDetail
    â”‚  â”‚
    â”‚  â””â”€ é¢„è®¢æ“ä½œ
    â”‚     â”œâ”€ GET /trips/:id/bookings
    â”‚     â”œâ”€ POST /trips/:id/bookings
    â”‚     â”œâ”€ PUT /trips/:id/bookings/:bookingId
    â”‚     â””â”€ DELETE /trips/:id/bookings/:bookingId
    â”‚
    â””â”€ PlanStudioSidebar
       â”‚
       â”œâ”€ æ•°æ®åŠ è½½
       â”‚  â”œâ”€ GET /trips/:id
       â”‚  â”‚  â””â”€ trip: TripDetail
       â”‚  â”‚
       â”‚  â”œâ”€ GET /trips/:id/persona-alerts
       â”‚  â”‚  â””â”€ PersonaAlert[]
       â”‚  â”‚
       â”‚  â”œâ”€ GET /trips/:id/metrics
       â”‚  â”‚  â””â”€ TripMetricsResponse
       â”‚  â”‚
       â”‚  â”œâ”€ GET /trips/:id/intent
       â”‚  â”‚  â””â”€ IntentResponse
       â”‚  â”‚
       â”‚  â””â”€ GET /readiness/trips/:id
       â”‚     â””â”€ ReadinessResponse
       â”‚        â”œâ”€ summary
       â”‚        â”œâ”€ findings
       â”‚        â””â”€ risks
       â”‚
       â””â”€ æ“ä½œæ¥å£
          â”œâ”€ POST /trips/:id/validate-safety
          â”‚  â””â”€ ValidateSafetyRequest
          â”‚
          â”œâ”€ POST /trips/:id/adjust-pacing
          â”‚  â””â”€ AdjustPacingRequest
          â”‚
          â””â”€ POST /trips/:id/replace-nodes
             â””â”€ ReplaceNodesRequest
```

---

## ğŸ“Š çŠ¶æ€ç®¡ç†æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   çŠ¶æ€ç®¡ç†æ¶æ„                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PlanStudioPage State
â”‚
â”œâ”€ è·¯ç”±çŠ¶æ€ (æ¥è‡ª URL)
â”‚  â”œâ”€ tripId: string | null (searchParams.get('tripId'))
â”‚  â””â”€ activeTab: string (searchParams.get('tab') || 'intent')
â”‚
â”œâ”€ UI çŠ¶æ€
â”‚  â”œâ”€ personaMode: PersonaMode ('abu' | 'dre' | 'neptune')
â”‚  â”œâ”€ loading: boolean
â”‚  â”œâ”€ hasTrips: boolean
â”‚  â”œâ”€ tripExists: boolean
â”‚  â”œâ”€ showWelcomeModal: boolean
â”‚  â”œâ”€ showTour: boolean
â”‚  â”œâ”€ refreshKey: number (ç”¨äºè§¦å‘å­ç»„ä»¶åˆ·æ–°)
â”‚  â”œâ”€ readinessDrawerOpen: boolean
â”‚  â””â”€ highlightFindingId: string | undefined
â”‚
â””â”€ å­ç»„ä»¶çŠ¶æ€ (å„æ ‡ç­¾é¡µç‹¬ç«‹ç®¡ç†)
   â”‚
   â”œâ”€ IntentTab State
   â”‚  â”œâ”€ trip: TripDetail | null
   â”‚  â”œâ”€ loading: boolean
   â”‚  â”œâ”€ saving: boolean
   â”‚  â”œâ”€ rhythm: 'relaxed' | 'standard' | 'tight'
   â”‚  â”œâ”€ preferences: string[]
   â”‚  â”œâ”€ dailyWalkLimit: number
   â”‚  â”œâ”€ earlyRiser: boolean
   â”‚  â”œâ”€ nightOwl: boolean
   â”‚  â”œâ”€ mustPlaces: string[]
   â”‚  â”œâ”€ mustPlaceMap: Map<number, PlaceWithDistance>
   â”‚  â”œâ”€ avoidPlaces: string[]
   â”‚  â”œâ”€ avoidPlaceMap: Map<number, PlaceWithDistance>
   â”‚  â”œâ”€ budget: number | undefined
   â”‚  â”œâ”€ planningPolicy: 'safe' | 'experience' | 'challenge'
   â”‚  â””â”€ åœ°ç‚¹æœç´¢çŠ¶æ€
   â”‚     â”œâ”€ mustPlaceSearchOpen: boolean
   â”‚     â”œâ”€ mustPlaceSearchQuery: string
   â”‚     â”œâ”€ mustPlaceSearchResults: PlaceWithDistance[]
   â”‚     â”œâ”€ avoidPlaceSearchOpen: boolean
   â”‚     â”œâ”€ avoidPlaceSearchQuery: string
   â”‚     â””â”€ avoidPlaceSearchResults: PlaceWithDistance[]
   â”‚
   â”œâ”€ PlacesTab State
   â”‚  â”œâ”€ trip: TripDetail | null
   â”‚  â”œâ”€ searchQuery: string
   â”‚  â”œâ”€ searchMode: 'search' | 'nearby' | 'recommend'
   â”‚  â”œâ”€ selectedCategory: PlaceCategory | 'all'
   â”‚  â”œâ”€ results: PlaceWithDistance[]
   â”‚  â”œâ”€ loading: boolean
   â”‚  â”œâ”€ error: string | null
   â”‚  â”œâ”€ userLocation: { lat: number; lng: number } | null
   â”‚  â”œâ”€ selectedPlace: PlaceWithDistance | null
   â”‚  â”œâ”€ addDialogOpen: boolean
   â”‚  â”œâ”€ selectedDayId: string
   â”‚  â”œâ”€ adding: boolean
   â”‚  â””â”€ successMessage: string | null
   â”‚
   â”œâ”€ ScheduleTab State
   â”‚  â”œâ”€ trip: TripDetail | null
   â”‚  â”œâ”€ schedules: Map<string, ScheduleResponse>
   â”‚  â”œâ”€ loading: boolean
   â”‚  â”œâ”€ itineraryItemsMap: Map<string, ItineraryItemDetail[]>
   â”‚  â”œâ”€ dayMetricsMap: Map<string, DayMetricsResponse>
   â”‚  â”œâ”€ conflicts: PlanStudioConflict[]
   â”‚  â”œâ”€ editingItem: ItineraryItem | null
   â”‚  â”œâ”€ editDialogOpen: boolean
   â”‚  â”œâ”€ replacingItem: { id: string; placeName?: string } | null
   â”‚  â”œâ”€ replaceDialogOpen: boolean
   â”‚  â”œâ”€ moveDialogOpen: boolean
   â”‚  â”œâ”€ movingItem: { id: string; currentDayId: string } | null
   â”‚  â”œâ”€ moveDayId: string
   â”‚  â”œâ”€ moveStartTime: string
   â”‚  â”œâ”€ moveEndTime: string
   â”‚  â”œâ”€ moving: boolean
   â”‚  â”œâ”€ deleteDialogOpen: boolean
   â”‚  â”œâ”€ deletingItem: { id: string; placeName: string } | null
   â”‚  â”œâ”€ optimizing: boolean
   â”‚  â””â”€ addingBuffers: boolean
   â”‚
   â”œâ”€ OptimizeTab State
   â”‚  â”œâ”€ trip: TripDetail | null
   â”‚  â”œâ”€ loading: boolean
   â”‚  â”œâ”€ result: OptimizeRouteResponse | null
   â”‚  â””â”€ error: string | null
   â”‚
   â”œâ”€ WhatIfTab State
   â”‚  â”œâ”€ trip: TripDetail | null
   â”‚  â””â”€ ... (å‡è®¾åˆ†æç›¸å…³çŠ¶æ€)
   â”‚
   â”œâ”€ BookingsTab State
   â”‚  â”œâ”€ trip: TripDetail | null
   â”‚  â””â”€ ... (é¢„è®¢ç›¸å…³çŠ¶æ€)
   â”‚
   â””â”€ PlanStudioSidebar State
      â”œâ”€ trip: TripDetail | null
      â”œâ”€ loading: boolean
      â”œâ”€ alerts: PersonaAlert[]
      â”œâ”€ processing: boolean
      â”œâ”€ metrics: TripMetricsResponse | null
      â”œâ”€ intent: IntentResponse | null
      â”œâ”€ loadingMetrics: boolean
      â”œâ”€ neptuneReplacements: any[]
      â”œâ”€ operationResult: { type: 'success' | 'info' | 'warning'; message: string } | null
      â”œâ”€ readinessSummary: ReadinessSummary | null
      â””â”€ loadingReadiness: boolean
```

---

## ğŸ”„ äº¤äº’æµç¨‹æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·äº¤äº’æµç¨‹                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”¨æˆ·æ“ä½œæµç¨‹
    â”‚
    â”œâ”€ è¿›å…¥è§„åˆ’å·¥ä½œå°
    â”‚  â”œâ”€ æ£€æŸ¥æ˜¯å¦æœ‰è¡Œç¨‹
    â”‚  â”‚  â”œâ”€ æ— è¡Œç¨‹ â†’ æ˜¾ç¤º WelcomeModal
    â”‚  â”‚  â””â”€ æœ‰è¡Œç¨‹ â†’ åŠ è½½è¡Œç¨‹æ•°æ®
    â”‚  â”‚
    â”‚  â””â”€ é¦–æ¬¡è¿›å…¥ â†’ æ˜¾ç¤º SpotlightTour (åŠŸèƒ½å¼•å¯¼)
    â”‚
    â”œâ”€ æ„å›¾é…ç½® (IntentTab)
    â”‚  â”œâ”€ è®¾ç½®èŠ‚å¥ (relaxed/standard/tight)
    â”‚  â”œâ”€ é€‰æ‹©åå¥½ (å¤šé€‰)
    â”‚  â”œâ”€ è®¾ç½®ç¡¬çº¦æŸ
    â”‚  â”‚  â”œâ”€ æ¯æ—¥æ­¥è¡Œé™åˆ¶
    â”‚  â”‚  â”œâ”€ æ—©èµ·è€…/å¤œçŒ«å­
    â”‚  â”‚  â”œâ”€ æ·»åŠ å¿…é¡»åœ°ç‚¹
    â”‚  â”‚  â”‚  â””â”€ æœç´¢åœ°ç‚¹ â†’ é€‰æ‹© â†’ æ·»åŠ åˆ° mustPlaces
    â”‚  â”‚  â””â”€ æ·»åŠ é¿å…åœ°ç‚¹
    â”‚  â”‚     â””â”€ æœç´¢åœ°ç‚¹ â†’ é€‰æ‹© â†’ æ·»åŠ åˆ° avoidPlaces
    â”‚  â”‚
    â”‚  â”œâ”€ è®¾ç½®é¢„ç®—
    â”‚  â”œâ”€ é€‰æ‹©è§„åˆ’ç­–ç•¥
    â”‚  â””â”€ ç‚¹å‡» "ä¿å­˜" â†’ PUT /trips/:id/intent
    â”‚
    â”œâ”€ åœ°ç‚¹æœç´¢ (PlacesTab)
    â”‚  â”œâ”€ é€‰æ‹©æœç´¢æ¨¡å¼
    â”‚  â”‚  â”œâ”€ æœç´¢æ¨¡å¼ â†’ è¾“å…¥å…³é”®è¯ â†’ GET /places/search
    â”‚  â”‚  â”œâ”€ é™„è¿‘æ¨¡å¼ â†’ è·å–ä½ç½® â†’ GET /places/nearby
    â”‚  â”‚  â””â”€ æ¨èæ¨¡å¼ â†’ GET /places/recommend
    â”‚  â”‚
    â”‚  â”œâ”€ ç­›é€‰åˆ†ç±»
    â”‚  â”œâ”€ æŸ¥çœ‹åœ°ç‚¹è¯¦æƒ…
    â”‚  â”‚  â”œâ”€ æŸ¥çœ‹è¯æ®æ ‡ç­¾
    â”‚  â”‚  â””â”€ æŸ¥çœ‹è·ç¦»/è¯„åˆ†
    â”‚  â”‚
    â”‚  â””â”€ æ·»åŠ åœ°ç‚¹
    â”‚     â”œâ”€ ç‚¹å‡» "åŠ å…¥" â†’ æ‰“å¼€æ·»åŠ å¯¹è¯æ¡†
    â”‚     â”œâ”€ é€‰æ‹©æ—¥æœŸ
    â”‚     â””â”€ ç¡®è®¤æ·»åŠ  â†’ POST /trips/:id/items
    â”‚
    â”œâ”€ æ—¥ç¨‹å®‰æ’ (ScheduleTab)
    â”‚  â”œâ”€ æŸ¥çœ‹æ—¥ç¨‹æ—¶é—´çº¿
    â”‚  â”‚  â”œâ”€ Day 1 ~ Day N
    â”‚  â”‚  â””â”€ æ¯ä¸ªæ—¥æœŸä¸‹çš„è¡Œç¨‹é¡¹åˆ—è¡¨
    â”‚  â”‚
    â”‚  â”œâ”€ æ‹–æ‹½æ’åº
    â”‚  â”‚  â””â”€ æ‹–æ‹½è¡Œç¨‹é¡¹ â†’ æ›´æ–°é¡ºåº â†’ PUT /trips/:id/items/:itemId
    â”‚  â”‚
    â”‚  â”œâ”€ ç¼–è¾‘è¡Œç¨‹é¡¹
    â”‚  â”‚  â”œâ”€ ç‚¹å‡» "ç¼–è¾‘" â†’ EditItineraryItemDialog
    â”‚  â”‚  â””â”€ ä¿å­˜ â†’ PUT /trips/:id/items/:itemId
    â”‚  â”‚
    â”‚  â”œâ”€ æ›¿æ¢è¡Œç¨‹é¡¹
    â”‚  â”‚  â”œâ”€ ç‚¹å‡» "æ›¿æ¢" â†’ ReplaceItineraryItemDialog
    â”‚  â”‚  â””â”€ ç¡®è®¤æ›¿æ¢ â†’ POST /trips/:id/items/:itemId/replace
    â”‚  â”‚
    â”‚  â”œâ”€ ç§»åŠ¨è¡Œç¨‹é¡¹
    â”‚  â”‚  â”œâ”€ ç‚¹å‡» "ç§»åŠ¨" â†’ MoveItemDialog
    â”‚  â”‚  â”œâ”€ é€‰æ‹©ç›®æ ‡æ—¥æœŸå’Œæ—¶é—´
    â”‚  â”‚  â””â”€ ç¡®è®¤ç§»åŠ¨ â†’ PUT /trips/:id/items/:itemId/move
    â”‚  â”‚
    â”‚  â”œâ”€ åˆ é™¤è¡Œç¨‹é¡¹
    â”‚  â”‚  â”œâ”€ ç‚¹å‡» "åˆ é™¤" â†’ DeleteItemAlertDialog
    â”‚  â”‚  â””â”€ ç¡®è®¤åˆ é™¤ â†’ DELETE /trips/:id/items/:itemId
    â”‚  â”‚
    â”‚  â”œâ”€ å¤„ç†å†²çª
    â”‚  â”‚  â”œâ”€ æŸ¥çœ‹å†²çªåˆ—è¡¨
    â”‚  â”‚  â”œâ”€ ç‚¹å‡» "ä¿®å¤" â†’ è‡ªåŠ¨å®šä½åˆ°å†²çªé¡¹
    â”‚  â”‚  â””â”€ æ‰‹åŠ¨è°ƒæ•´æˆ–è‡ªåŠ¨ä¿®å¤
    â”‚  â”‚
    â”‚  â”œâ”€ è¿è¡Œä¼˜åŒ–
    â”‚  â”‚  â”œâ”€ ç‚¹å‡» "è¿è¡Œä¼˜åŒ–" â†’ POST /itinerary-optimization/optimize
    â”‚  â”‚  â”œâ”€ æ˜¾ç¤ºä¼˜åŒ–ç»“æœ
    â”‚  â”‚  â””â”€ åº”ç”¨ä¼˜åŒ– â†’ POST /trips/:id/optimize/apply
    â”‚  â”‚
    â”‚  â””â”€ æ·»åŠ ç¼“å†²
    â”‚     â””â”€ ç‚¹å‡» "æ·»åŠ ç¼“å†²" â†’ è‡ªåŠ¨åœ¨è¡Œç¨‹é¡¹ä¹‹é—´æ·»åŠ ç¼“å†²æ—¶é—´
    â”‚
    â”œâ”€ è·¯çº¿ä¼˜åŒ– (OptimizeTab)
    â”‚  â”œâ”€ æŸ¥çœ‹ä¼˜åŒ–å‰çŠ¶æ€
    â”‚  â”œâ”€ é…ç½®ä¼˜åŒ–å‚æ•°
    â”‚  â”‚  â”œâ”€ ä¼˜åŒ–ç›®æ ‡
    â”‚  â”‚  â””â”€ ä¼˜åŒ–å‚æ•°
    â”‚  â”‚
    â”‚  â”œâ”€ è¿è¡Œä¼˜åŒ–
    â”‚  â”‚  â””â”€ POST /itinerary-optimization/optimize
    â”‚  â”‚
    â”‚  â”œâ”€ æŸ¥çœ‹ä¼˜åŒ–ç»“æœ
    â”‚  â”‚  â”œâ”€ Before/After å¯¹æ¯”
    â”‚  â”‚  â”œâ”€ å˜æ›´åˆ—è¡¨
    â”‚  â”‚  â”‚  â”œâ”€ å˜æ›´ç±»å‹
    â”‚  â”‚  â”‚  â”œâ”€ åŸå› ç 
    â”‚  â”‚  â”‚  â””â”€ è¯æ®é“¾æ¥
    â”‚  â”‚  â”‚
    â”‚  â””â”€ åº”ç”¨ä¼˜åŒ–
    â”‚     â””â”€ ç‚¹å‡» "åº”ç”¨ä¼˜åŒ–" â†’ å°†ä¼˜åŒ–ç»“æœåº”ç”¨åˆ°è¡Œç¨‹
    â”‚
    â”œâ”€ å‡è®¾åˆ†æ (WhatIfTab)
    â”‚  â”œâ”€ é€‰æ‹©å‡è®¾åœºæ™¯
    â”‚  â”œâ”€ è°ƒæ•´å‚æ•°
    â”‚  â””â”€ æŸ¥çœ‹ç»“æœé¢„è§ˆ
    â”‚
    â”œâ”€ é¢„è®¢ç®¡ç† (BookingsTab)
    â”‚  â”œâ”€ æŸ¥çœ‹é¢„è®¢åˆ—è¡¨
    â”‚  â”œâ”€ æ·»åŠ é¢„è®¢
    â”‚  â”œâ”€ ç¼–è¾‘é¢„è®¢
    â”‚  â””â”€ åˆ é™¤é¢„è®¢
    â”‚
    â”œâ”€ å³ä¾§æ æ“ä½œ
    â”‚  â”œâ”€ æŸ¥çœ‹å‡†å¤‡åº¦æ‘˜è¦
    â”‚  â”‚  â””â”€ ç‚¹å‡» "æŸ¥çœ‹è¯¦æƒ…" â†’ ReadinessDrawer
    â”‚  â”‚
    â”‚  â”œâ”€ æŸ¥çœ‹äººæ ¼æé†’
    â”‚  â”‚  â”œâ”€ æ ¹æ® personaMode è¿‡æ»¤æé†’
    â”‚  â”‚  â””â”€ ç‚¹å‡»æé†’ â†’ æ‰§è¡Œç›¸åº”æ“ä½œ
    â”‚  â”‚
    â”‚  â”œâ”€ æŸ¥çœ‹æŒ‡æ ‡
    â”‚  â”‚  â”œâ”€ æ€»æ—¶é•¿
    â”‚  â”‚  â”œâ”€ æ€»è·ç¦»
    â”‚  â”‚  â”œâ”€ æ€»é¢„ç®—
    â”‚  â”‚  â””â”€ å…¶ä»–æŒ‡æ ‡
    â”‚  â”‚
    â”‚  â””â”€ æ‰§è¡Œæ“ä½œ
    â”‚     â”œâ”€ "éªŒè¯å®‰å…¨" â†’ POST /trips/:id/validate-safety
    â”‚     â”œâ”€ "è°ƒæ•´èŠ‚å¥" â†’ POST /trips/:id/adjust-pacing
    â”‚     â””â”€ "åº”ç”¨ä¿®å¤" â†’ POST /trips/:id/replace-nodes
    â”‚
    â””â”€ è§†å›¾åˆ‡æ¢
       â””â”€ PersonaModeToggle
          â”œâ”€ åˆ‡æ¢åˆ° Abu â†’ æ˜¾ç¤ºå®‰å…¨ç›¸å…³æé†’å’Œæ“ä½œ
          â”œâ”€ åˆ‡æ¢åˆ° Dr.Dre â†’ æ˜¾ç¤ºèŠ‚å¥ç›¸å…³æé†’å’Œæ“ä½œ
          â””â”€ åˆ‡æ¢åˆ° Neptune â†’ æ˜¾ç¤ºä¿®å¤ç›¸å…³æé†’å’Œæ“ä½œ
```

---

## ğŸ”— å…³é”®æ•°æ®æµè·¯å¾„

### è·¯å¾„1: æ„å›¾é…ç½®æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
    â”‚
    â–¼
IntentTab è¡¨å•çŠ¶æ€
    â”‚
    â”œâ”€ rhythm: 'standard'
    â”œâ”€ preferences: ['nature', 'food']
    â”œâ”€ dailyWalkLimit: 10
    â”œâ”€ mustPlaces: ['123', '456']
    â””â”€ budget: 5000
    â”‚
    â–¼
ç‚¹å‡» "ä¿å­˜"
    â”‚
    â”œâ”€ PUT /trips/:id
    â”‚  â””â”€ { totalBudget: 5000 }
    â”‚
    â””â”€ PUT /trips/:id/intent
       â””â”€ {
            pacingConfig: {
              level: 'standard',
              maxDailyActivities: 5
            },
            preferences: ['nature', 'food'],
            constraints: {
              dailyWalkLimit: 10,
              mustPlaces: [123, 456]
            },
            totalBudget: 5000
          }
       â”‚
       â–¼
   é‡æ–°åŠ è½½æ•°æ®
       â”‚
       â”œâ”€ GET /trips/:id/intent
       â””â”€ æ›´æ–°è¡¨å•çŠ¶æ€
```

### è·¯å¾„2: åœ°ç‚¹æ·»åŠ æ•°æ®æµ

```
PlacesTab
    â”‚
    â”œâ”€ æœç´¢åœ°ç‚¹
    â”‚  â””â”€ GET /places/search?q={query}
    â”‚     â””â”€ PlaceWithDistance[]
    â”‚
    â”œâ”€ é€‰æ‹©åœ°ç‚¹
    â”‚  â””â”€ setSelectedPlace(place)
    â”‚
    â”œâ”€ æ‰“å¼€æ·»åŠ å¯¹è¯æ¡†
    â”‚  â””â”€ setAddDialogOpen(true)
    â”‚
    â”œâ”€ é€‰æ‹©æ—¥æœŸ
    â”‚  â””â”€ setSelectedDayId(dayId)
    â”‚
    â””â”€ ç¡®è®¤æ·»åŠ 
       â””â”€ POST /trips/:id/items
          â””â”€ {
               placeId: 123,
               dayId: 'day-1',
               metadata: {...}
             }
          â”‚
          â–¼
      åˆ·æ–° ScheduleTab
          â”‚
          â””â”€ setRefreshKey(prev => prev + 1)
             â”‚
             â–¼
          ScheduleTab useEffect è§¦å‘
             â”‚
             â””â”€ é‡æ–°åŠ è½½æ—¥ç¨‹æ•°æ®
```

### è·¯å¾„3: æ—¥ç¨‹ä¼˜åŒ–æ•°æ®æµ

```
ScheduleTab
    â”‚
    â”œâ”€ æ”¶é›†åœ°ç‚¹ID
    â”‚  â””â”€ placeIds: [123, 456, 789]
    â”‚
    â”œâ”€ æ„å»ºä¼˜åŒ–è¯·æ±‚
    â”‚  â””â”€ OptimizeRouteRequest
    â”‚     â”œâ”€ placeIds: [123, 456, 789]
    â”‚     â””â”€ config: {
    â”‚          date: '2025-01-01',
    â”‚          startTime: '09:00',
    â”‚          endTime: '18:00',
    â”‚          pacingFactor: 1.0
    â”‚        }
    â”‚
    â”œâ”€ è¿è¡Œä¼˜åŒ–
    â”‚  â””â”€ POST /itinerary-optimization/optimize
    â”‚     â””â”€ OptimizeRouteResponse
    â”‚        â”œâ”€ schedule: ScheduleItem[]
    â”‚        â”œâ”€ changes: Change[]
    â”‚        â””â”€ metrics: Metrics
    â”‚
    â”œâ”€ æ˜¾ç¤ºä¼˜åŒ–ç»“æœ
    â”‚  â””â”€ OptimizeTab
    â”‚     â”œâ”€ Before/After å¯¹æ¯”
    â”‚     â””â”€ å˜æ›´åˆ—è¡¨
    â”‚
    â””â”€ åº”ç”¨ä¼˜åŒ–
       â””â”€ POST /trips/:id/optimize/apply
          â””â”€ æ›´æ–°è¡Œç¨‹é¡¹æ—¶é—´
             â”‚
             â–¼
         åˆ·æ–°æ—¥ç¨‹æ˜¾ç¤º
```

### è·¯å¾„4: å‡†å¤‡åº¦æ•°æ®æµ

```
PlanStudioSidebar
    â”‚
    â”œâ”€ åŠ è½½å‡†å¤‡åº¦æ‘˜è¦
    â”‚  â””â”€ GET /readiness/trips/:id
    â”‚     â””â”€ ReadinessResponse
    â”‚        â”œâ”€ summary: {
    â”‚        â”‚   totalBlockers: 2,
    â”‚        â”‚   totalMust: 5,
    â”‚        â”‚   totalShould: 8,
    â”‚        â”‚   totalOptional: 3
    â”‚        â”‚ }
    â”‚        â”œâ”€ findings: Finding[]
    â”‚        â””â”€ risks: Risk[]
    â”‚
    â”œâ”€ æ˜¾ç¤ºæ‘˜è¦å¡ç‰‡
    â”‚  â””â”€ å‡†å¤‡åº¦æ‘˜è¦å¡ç‰‡
    â”‚     â”œâ”€ é˜»å¡é¡¹: 2
    â”‚     â”œâ”€ å¿…é¡»é¡¹: 5
    â”‚     â”œâ”€ åº”è¯¥é¡¹: 8
    â”‚     â””â”€ å¯é€‰é¡¹: 3
    â”‚
    â””â”€ ç‚¹å‡» "æŸ¥çœ‹è¯¦æƒ…"
       â””â”€ setReadinessDrawerOpen(true)
          â”‚
          â–¼
       ReadinessDrawer
          â”‚
          â””â”€ æ˜¾ç¤ºå®Œæ•´å‡†å¤‡åº¦ä¿¡æ¯
             â”œâ”€ è¯¦ç»†æ‘˜è¦
             â”œâ”€ é£é™©åˆ—è¡¨
             â””â”€ ä¿®å¤å»ºè®®
```

---

## ğŸ“ˆ ä¿¡æ¯æ¶æ„å±‚æ¬¡ç»“æ„

```
Level 1: é¡µé¢å±‚çº§
â”œâ”€ PlanStudioPage (src/pages/plan-studio/index.tsx)
   â”‚
   â”œâ”€ Level 2: åŒºåŸŸå±‚çº§
   â”‚  â”œâ”€ é¡¶éƒ¨åŒºåŸŸ (Header Area)
   â”‚  â”œâ”€ æ ‡ç­¾é¡µå¯¼èˆª (Tabs Navigation)
   â”‚  â”œâ”€ ä¸»å†…å®¹åŒºåŸŸ (Main Content Area)
   â”‚  â”œâ”€ å³ä¾§æ åŒºåŸŸ (Sidebar Area)
   â”‚  â””â”€ å¼¹çª—å±‚ (Modal/Drawer Layer)
   â”‚     â”‚
   â”‚     â”œâ”€ Level 3: ç»„ä»¶å±‚çº§
   â”‚     â”‚  â”œâ”€ PersonaModeToggle
   â”‚     â”‚  â”œâ”€ Tabs (6ä¸ªæ ‡ç­¾é¡µ)
   â”‚     â”‚  â”œâ”€ PlanStudioSidebar
   â”‚     â”‚  â”œâ”€ WelcomeModal
   â”‚     â”‚  â”œâ”€ SpotlightTour
   â”‚     â”‚  â””â”€ ReadinessDrawer
   â”‚     â”‚     â”‚
   â”‚     â”‚     â”œâ”€ Level 4: æ ‡ç­¾é¡µç»„ä»¶å±‚çº§
   â”‚     â”‚     â”‚  â”œâ”€ IntentTab
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ Trip DNA é…ç½®å¡ç‰‡
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ Hard Constraints å¡ç‰‡
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ é¢„ç®—è®¾ç½®å¡ç‰‡
   â”‚     â”‚     â”‚  â”‚  â””â”€ åœ°ç‚¹æœç´¢ç»„ä»¶
   â”‚     â”‚     â”‚  â”‚
   â”‚     â”‚     â”‚  â”œâ”€ PlacesTab
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ æœç´¢åŒºåŸŸ
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ æœç´¢ç»“æœåˆ—è¡¨
   â”‚     â”‚     â”‚  â”‚  â””â”€ æ·»åŠ åœ°ç‚¹å¯¹è¯æ¡†
   â”‚     â”‚     â”‚  â”‚
   â”‚     â”‚     â”‚  â”œâ”€ ScheduleTab
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ æ—¥ç¨‹æ—¶é—´çº¿
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ å†²çªåˆ—è¡¨å¡ç‰‡
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ æ“ä½œæŒ‰é’®ç»„
   â”‚     â”‚     â”‚  â”‚  â””â”€ å¼¹çª—ç»„ä»¶ç»„
   â”‚     â”‚     â”‚  â”‚
   â”‚     â”‚     â”‚  â”œâ”€ OptimizeTab
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ ä¼˜åŒ–å‰/åå¯¹æ¯”
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ å˜æ›´åˆ—è¡¨
   â”‚     â”‚     â”‚  â”‚  â””â”€ ä¼˜åŒ–é…ç½®
   â”‚     â”‚     â”‚  â”‚
   â”‚     â”‚     â”‚  â”œâ”€ WhatIfTab
   â”‚     â”‚     â”‚  â”‚  â”œâ”€ å‡è®¾åœºæ™¯é…ç½®
   â”‚     â”‚     â”‚  â”‚  â””â”€ ç»“æœé¢„è§ˆ
   â”‚     â”‚     â”‚  â”‚
   â”‚     â”‚     â”‚  â””â”€ BookingsTab
   â”‚     â”‚     â”‚     â”œâ”€ é¢„è®¢åˆ—è¡¨
   â”‚     â”‚     â”‚     â””â”€ æ·»åŠ é¢„è®¢æŒ‰é’®
   â”‚     â”‚     â”‚
   â”‚     â”‚     â””â”€ Level 5: å­ç»„ä»¶å±‚çº§
   â”‚     â”‚        â”œâ”€ PlaceCard (åœ°ç‚¹å¡ç‰‡)
   â”‚     â”‚        â”œâ”€ ItineraryItemRow (è¡Œç¨‹é¡¹è¡Œ)
   â”‚     â”‚        â”œâ”€ ConflictCard (å†²çªå¡ç‰‡)
   â”‚     â”‚        â”œâ”€ AlertCard (æé†’å¡ç‰‡)
   â”‚     â”‚        â””â”€ ... (å…¶ä»–å­ç»„ä»¶)
   â”‚     â”‚
   â”‚     â””â”€ Level 6: æ•°æ®å±‚çº§
   â”‚        â”œâ”€ API æ•°æ® (trip, intent, metricsç­‰)
   â”‚        â”œâ”€ è¡¨å•çŠ¶æ€ (rhythm, preferencesç­‰)
   â”‚        â””â”€ UI çŠ¶æ€ (loading, dialogOpenç­‰)
```

---

## ğŸ¯ æ•°æ®æ˜ å°„å…³ç³»

```
API æ•°æ® â†’ ç»„ä»¶ä½¿ç”¨

trip (TripDetail)
  â”œâ”€ PlanStudioPage (éªŒè¯ tripId)
  â”œâ”€ IntentTab (æ˜¾ç¤ºå’Œç¼–è¾‘)
  â”œâ”€ PlacesTab (æ˜¾ç¤ºè¡Œç¨‹ä¿¡æ¯)
  â”œâ”€ ScheduleTab (æ˜¾ç¤ºæ—¥ç¨‹)
  â”œâ”€ OptimizeTab (æ˜¾ç¤ºè¡Œç¨‹ä¿¡æ¯)
  â”œâ”€ WhatIfTab (æ˜¾ç¤ºè¡Œç¨‹ä¿¡æ¯)
  â”œâ”€ BookingsTab (æ˜¾ç¤ºè¡Œç¨‹ä¿¡æ¯)
  â””â”€ PlanStudioSidebar (æ˜¾ç¤ºæŒ‡æ ‡)

intent (IntentResponse)
  â”œâ”€ IntentTab (åŠ è½½å’Œä¿å­˜é…ç½®)
  â””â”€ PlanStudioSidebar (æ˜¾ç¤ºæ„å›¾ä¿¡æ¯)

schedules (ScheduleResponse[])
  â””â”€ ScheduleTab (æ˜¾ç¤ºæ—¥ç¨‹æ—¶é—´çº¿)

metrics (TripMetricsResponse)
  â”œâ”€ ScheduleTab (æ˜¾ç¤ºæŒ‡æ ‡)
  â””â”€ PlanStudioSidebar (æ˜¾ç¤ºæŒ‡æ ‡å¡ç‰‡)

conflicts (PlanStudioConflict[])
  â””â”€ ScheduleTab (æ˜¾ç¤ºå†²çªåˆ—è¡¨)

alerts (PersonaAlert[])
  â””â”€ PlanStudioSidebar (æ˜¾ç¤ºäººæ ¼æé†’)

readiness (ReadinessResponse)
  â””â”€ PlanStudioSidebar (æ˜¾ç¤ºå‡†å¤‡åº¦æ‘˜è¦)
```

---

## ğŸ” å…³é”®åŠŸèƒ½æ¨¡å—

### æ¨¡å—1: æ„å›¾é…ç½®æ¨¡å— (IntentTab)

```
åŠŸèƒ½: é…ç½®è¡Œç¨‹çš„æ„å›¾å’Œçº¦æŸ
    â”‚
    â”œâ”€ Trip DNA é…ç½®
    â”‚  â”œâ”€ èŠ‚å¥é€‰æ‹© (relaxed/standard/tight)
    â”‚  â””â”€ åå¥½é€‰æ‹© (å¤šé€‰)
    â”‚
    â”œâ”€ Hard Constraints
    â”‚  â”œâ”€ æ¯æ—¥æ­¥è¡Œé™åˆ¶
    â”‚  â”œâ”€ æ—©èµ·è€…/å¤œçŒ«å­
    â”‚  â”œâ”€ å¿…é¡»åœ°ç‚¹ (Must Places)
    â”‚  â””â”€ é¿å…åœ°ç‚¹ (Avoid Places)
    â”‚
    â”œâ”€ é¢„ç®—è®¾ç½®
    â”‚  â””â”€ æ€»é¢„ç®—è¾“å…¥
    â”‚
    â””â”€ è§„åˆ’ç­–ç•¥
       â””â”€ safe/experience/challenge é€‰æ‹©
```

### æ¨¡å—2: åœ°ç‚¹æœç´¢æ¨¡å— (PlacesTab)

```
åŠŸèƒ½: æœç´¢å’Œæ·»åŠ åœ°ç‚¹åˆ°è¡Œç¨‹
    â”‚
    â”œâ”€ æœç´¢åŠŸèƒ½
    â”‚  â”œâ”€ æœç´¢æ¨¡å¼ (search/nearby/recommend)
    â”‚  â”œâ”€ å…³é”®è¯æœç´¢
    â”‚  â”œâ”€ é™„è¿‘æœç´¢ (åŸºäºåœ°ç†ä½ç½®)
    â”‚  â””â”€ æ¨èæœç´¢ (åŸºäºè¡Œç¨‹æ„å›¾)
    â”‚
    â”œâ”€ ç­›é€‰åŠŸèƒ½
    â”‚  â””â”€ åˆ†ç±»ç­›é€‰ (PlaceCategory)
    â”‚
    â”œâ”€ åœ°ç‚¹å±•ç¤º
    â”‚  â”œâ”€ åœ°ç‚¹å¡ç‰‡åˆ—è¡¨
    â”‚  â”œâ”€ è¯æ®æ ‡ç­¾æ˜¾ç¤º
    â”‚  â””â”€ è·ç¦»/è¯„åˆ†æ˜¾ç¤º
    â”‚
    â””â”€ æ·»åŠ åŠŸèƒ½
       â”œâ”€ é€‰æ‹©æ—¥æœŸ
       â””â”€ åˆ›å»ºè¡Œç¨‹é¡¹
```

### æ¨¡å—3: æ—¥ç¨‹å®‰æ’æ¨¡å— (ScheduleTab)

```
åŠŸèƒ½: å®‰æ’å’Œç®¡ç†æ—¥ç¨‹
    â”‚
    â”œâ”€ æ—¶é—´çº¿å±•ç¤º
    â”‚  â”œâ”€ Day 1 ~ Day N
    â”‚  â””â”€ æ¯ä¸ªæ—¥æœŸä¸‹çš„è¡Œç¨‹é¡¹åˆ—è¡¨
    â”‚
    â”œâ”€ æ‹–æ‹½æ’åº
    â”‚  â””â”€ æ‹–æ‹½è¡Œç¨‹é¡¹è°ƒæ•´é¡ºåº
    â”‚
    â”œâ”€ è¡Œç¨‹é¡¹æ“ä½œ
    â”‚  â”œâ”€ ç¼–è¾‘è¡Œç¨‹é¡¹
    â”‚  â”œâ”€ æ›¿æ¢è¡Œç¨‹é¡¹
    â”‚  â”œâ”€ ç§»åŠ¨è¡Œç¨‹é¡¹
    â”‚  â””â”€ åˆ é™¤è¡Œç¨‹é¡¹
    â”‚
    â”œâ”€ å†²çªå¤„ç†
    â”‚  â”œâ”€ å†²çªæ£€æµ‹
    â”‚  â”œâ”€ å†²çªåˆ—è¡¨æ˜¾ç¤º
    â”‚  â””â”€ å†²çªä¿®å¤
    â”‚
    â””â”€ ä¼˜åŒ–åŠŸèƒ½
       â”œâ”€ è¿è¡Œä¼˜åŒ–
       â”œâ”€ æ·»åŠ ç¼“å†²
       â””â”€ åº”ç”¨ä¼˜åŒ–ç»“æœ
```

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-01-XX  
**ç»´æŠ¤è€…**: å‰ç«¯å›¢é˜Ÿ


```


